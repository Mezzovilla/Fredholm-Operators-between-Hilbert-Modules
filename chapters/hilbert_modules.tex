\chapter[Hilbert \texorpdfstring{\ensuremath{C^*}}{C*}-modules]{Hilbert \texorpdfstring{\mathbf{C^*}}{C*}-modules}
\label{ch:hilbert modules}

Hilbert modules first appeared in the work of \textsc{I. Kaplansky} \cite{kaplansky1953modules} and \textsc{W. Paschke} \cite{paschke1973inner} later. There are three main areas where Hilbert $C^*$-modules are heavily used to formulate mathematical concepts involving:
\begin{itroman}
    \item\label{main areas (i)} \textbf{Induced representations of Morita equivalence} \cite{brown1977stable, RIEFFEL1974176,rieffel1981c};
    \item \textbf{Kasparov's $\mathbf{KK}$-theory} \cite{kasparov1980stinespring};
    
    \item \textbf{Cuntz-Pimsner algebras} \cite{Schafhauser2015CuntzPimsner, robertson2011extensions, browlowe2004exel}; %\textit{C. Schafhauser} which includes some of the Exel's s techniques, showing that the order structure on K0 can also be defined in terms of Fredholm operators and every row-finite $C^*$-correspondence induces a homomorphism on K-theory that preserves the order structure on K0.
    \item \textbf{$\mathbf{C^*}$-algebraic quantum groups} \cite{woronowicz1991unbounded, abadie1996hilbert};
    \item \textbf{Quantum Stochastic Differential Geometry} \cite{applebaum1988quantum}.
\end{itroman}

In what is tangible to this work, we address the Morita equivalence target by building a Fredholm operator approach between Hilbert modules, introduced by \textsc{R. Exel} \cite{exel7fredholm}. Hence, this chapter is responsible for defining and studying those objects.

The material source contains for this chapter is contained the well written textbooks like \cite{lance1995hilbert,jensen2012elements, manuilov2001hilbert}.

\section{The interest object}
\label{sec:definicao de hilbert c-star-modules}

%The star of the show were introduced by 


\begin{definicao}[Inner Product Module]
\label{def: pre-hilb module}
A right module $E$ over a $C^*$-algebra (non-necessarily unital) blessed with a generalized inner product $\langle \come, \come\rangle : E \times E \longto A$ will be said to be a \textit{inner product module} when $\inner\come\come$ attends the following properties:
\begin{itroman}
\item \textbf{Twisted $\boldsymbol A$-sesquilinear}: The first coordinate are involute-linear and the second one linear, i.e.,
\begin{eqspaced*}{\left(\begin{array}{c}
     x,y,z\in E\\ a\in A
\end{array}\right)}
    \hspace{-1.25cm}
    \begin{cases}
        \langle x+ya, z\rangle = \langle x,z\rangle + a^*\langle y,z\rangle   \\
        \langle z, x+ya\rangle = \langle z,x\rangle + \langle z,y\rangle a  \\
    \end{cases}
\end{eqspaced*}
\item \label{item: Hermitian symmetry}\textbf{$\boldsymbol A$-Hermitian symmetry}: $\langle x,y \rangle = {\langle y,x \rangle}^*$ whenever $x,y \in E$.
\item \label{def item: positivo definido}\textbf{Positive definite}: For any $x\in E$, $\langle x,x\rangle = 0 \Leftrightarrow x=0$. By \ref{item: Hermitian symmetry}, we can say that $\langle x,x\rangle \geq 0$ since it is self-adjoint.
\end{itroman}
One could argue that we only need the inner product to be linear in the second coordinate and by the Hermitian symmetry conclude as a proposition that every inner product over Inner product modules is indeed twisted sesquilinear. 
\end{definicao}

\begin{proposicao}[Cauchy-Schwartz inequality]\label{prop: Cauchy-Schwartz}
For any Inner product module $E$ over $A$, the following inequality holds: 
\begin{eqspaced}{(x,y \in E)}
\label{eq: cauchy-schwarts}
{\|\inner xy\|}^{2} \leq \|\inner xx\| \cdot \|\inner yy\|.
\end{eqspaced}
\begin{proof}
    Given the fact that $0\leq \inner aa$ for $a\in A$, notice that with the accessory elements $a\coloneqq \inner xx$, $b \coloneqq \inner yy$ and $c\coloneqq \inner xy$,
    \begin{eqspaced*}{(t \in \R)}
    \hspace{-0.5cm}
    \begin{array}{rcl}
        0 & \leq & \inner{x -  yt c^*}{x - y t c^*} \\
        &=& \vphantom{\displaystyle \int_a^b} 
            \inner x{x - y t  c^*}- tc\inner{y}{x - y t  c^*} \\
        &=& \inner xx - \inner xy\,tc^* - tc\inner yx + tc\inner yytc^* \\
        &=& \vphantom{\displaystyle \int_a^b}
            a - 2tcc^*+ t^2cbc^*
    \end{array}
    \end{eqspaced*}
    
    Since $2t c c^*$ is self-adjoint, we can add in both sides and maintain the inequality in the $C^*$-realm. Using the $A$-norm and assuming $t \geq 0$, %\ref{lema: Cstar prop: a <= b ---> |a| <= |b|}
    \begin{eqnarray}
     2t \|cc^*\| &\leq& \|a \| + t^2\|cb c^*\| \nonumber \\
                 &\leq & \vphantom{\displaystyle \int_a^b} \|a \| + t^2\|c\|\|b\|\|c^*\| \nonumber \\
    \label{eq: CS - polinomio quadrado}
    \To \hfill 2t\|c\|^2 &\leq&  \|a \| + t^2\|b\|\|c\|^2           
    \end{eqnarray}
    
    With a fairly nice quadratic polynomial in $\R[t]$ generated by (\ref{eq: CS - polinomio quadrado}) in our hands witch is always non negative, the discriminant must be non positive. Therefore:
    \begin{eqnarray}
        (-2\|c\|^2)^2 - 4\|b\|\|c\|^2 \|a\|  &\leq& 0 \nonumber\\
        \label{eq: CS - discriminante delta} \To \hfill
        \vphantom{\displaystyle \int_a^b}\|\inner xy\|^4 - \|\inner yy\|\|\inner xy\|^2 \|\inner xx\|  &\leq& 0 
    \end{eqnarray}
    
    Assuming  $\|\inner xy\|^2 \neq 0$ means that (\ref{eq: CS - discriminante delta}) can be simplified into Cauchy-Schwartz inequality (\ref{eq: cauchy-schwarts}) by canceling $\|\inner xy\|^2$. Otherwise\footnote{Note that $\|\inner xy\|^2=0$ if and only if $\inner xy=0$.}, $\inner xy=0$ is a trivial case of the desired inequality.
    \end{proof}
\end{proposicao}

For any $A$-valued inner product as above, we define a norm $\|x\| \coloneqq \sqrt{\sub{\|\inner xx\|}A}$ on a Inner product $C^*$-module. Which means that for arbitrary $x,y \in E$ and $a\in A$, the following holds:
\begin{itroman}
\item $\|x\| = 0 \sse x=0$.
\item $\|xa\| = \sub{\|a\|}A \|x\|$.
\item \label{item: desigualdade triangular} $\|x+y\| \leq \|x\|+\|y\|$.
\end{itroman}

Notice that the triangle inequality \ref{item: desigualdade triangular} is a direct consequence of \ref{prop: Cauchy-Schwartz}:
\begin{eqnarray*}
\|x+y\|^2 &=& \Anorm{\inner{x+y}{x+y}} 
\\ &=& \Anorm{\inner x{x}+\inner xy+ \inner y{x}+\inner y{y}}
\\
&\leq& \|x\|^2 + \Anorm{\inner xy}+\Anorm{\inner xy^*} + \|y\|^2\\
&=& \|x\|^2  + 2\Anorm{\inner xy}+ \|y\|^2\\
&\overset{\ref{prop: Cauchy-Schwartz}}\leq & \|x\|^2+2\|x\|\|y\| + \|y\|^2 = \big(\|x\|+\|y\|\big)^2
\end{eqnarray*}
as in the good old days. One identity that still remais is the polarization one: For every sesquilinear form $\varsigma : E\times E \longto A$
\begin{eqspaced}{(x,y\in E)}
\label{eq: polarization}
4 \varsigma(y,x) = \sum_{n = 0}^3 i^n \varsigma({x+i^ny},{x+i^ny}).
\end{eqspaced}

Since it should be a normed space, hence a complex vector space, one may be concerned about the fact that $A$ doesn't necessarily have a unit and therefore, $zx$ for $z\in \C$ should be an worry. 

\begin{proposicao}
All inner product modules are naturally complex vector spaces, even the ones over non necessarily unital $C^*$-algebras.
\begin{proof}
Any Inner product module $E$ is a $\mathbb Z$-module naturally because it is an abelian group with respect to the addition, and so is that $-\inner xy = \inner x{-y}$. Therefore, since the proof of Cauchy-Schwartz inequality \ref{prop: Cauchy-Schwartz} doesn't depend on the unity of $A$, no extra analysis is needed. For any approximate unit $(\sub u\lambda)_\lambda \subset A$, $(x\sub u\lambda)_\lambda \subset E$ converges to $x$, whence, for $z\in \C$, let $zx \coloneqq \lim_\lambda x(z\sub u\lambda)$. Since $A$ is a vector space, all properties are guaranteed and we are done.
\end{proof}
\end{proposicao}

\begin{definicao}
Inner product modules are called \textit{Hilbert \ensuremath{C^*}-modules} when the induced norm is complete in the Cauchy sense.
\end{definicao}

\begin{proposicao}\label{prop: EA = E}
For a Hilbert $C^*$-module $E$ over $A$, let $EA$ denote the linear span of elements given by $xa$, for $x\in E$ and $a\in A$. Therefore $\con{EA} = E$.
\begin{proof}
If $(\sub u\lambda)_\lambda \subset A$ is a approximate unit for $A$, then for all $x\in E$:
\begin{equation*}
    \begin{array}{rcl}
        \lim_\lambda \inner{x-x\sub u\lambda}{x-x\sub u\lambda} &=& \lim_\lambda\big(\inner xx - \sub u\lambda \inner xx\big)  \\
        & & \hphantom{\lim_\lambda}- \lim_{\lambda} \big(\inner xx\sub u\lambda - \sub u\lambda \inner xx\sub u\lambda \big) = 0.
    \end{array}
\end{equation*}
Hence the elements of the form $x\sub u\lambda$ are dense in $E$. 
\end{proof}
\end{proposicao}

\begin{observacao}\label{obs: tornar um R-modulo em um K-modulo}
Let $A$ and $B$ be $C^*$-algebras. If $E$ is a Hilbert $B$-module and the ideal $I$ of the closure of the elements spanned by $\inner xy$ is contained in $A$, then there is a way to make $E$ into a Hilbert $A$-module without changing the inner product. Namely, let $(\sub u\lambda)_\lambda$ be an approximate unit for $I$. Then the identity
\begin{equation*}
\begin{array}{rcl}
    \inner{x \sub u\eta a-x \sub u\lambda a}{x \sub u\eta a-x \sub u\lambda a} &=& 
a^* \sub u\eta \inner xx \sub u\eta a+a^* \sub u\lambda \inner xx \sub u\lambda a \\ & & \hphantom{a^*}-a^* \sub u\eta \inner xx \sub u\lambda a-a^* \sub u\lambda \inner xx \sub u\eta a,
\end{array}
\end{equation*}
holds for all $x\in E$ and $a\in A$, showing that $(x\sub u\lambda a)_\lambda$ converges in $E$. We can define $x a=\lim x \sub u{\lambda} a$, and it is straightforward to check that this makes $E$ into a Hilbert $A$-module. This is particularly important when dealing with non unital $C^*$-algebras $A$, and we might have a look into the same module over $\widetilde A$.
\end{observacao}

\begin{exemplos}\label{exemplos de hilbert modules}
    $\left.\right.$
\begin{itroman}
    \item Any traditional complex Hilbert space is a Hilbert $\C$-module.    
    \item \label{item: soma direta de modulos de hilbert} Let $(E_i)_{i\in I}$ be a family of Hilbert $C^*$-modules over $A$. The direct sum will be:
    \[
    \bigoplus_{i\in I}E_i \coloneqq \Big\{x \in \prod_{i\in I} E_i \mid \sum_{i\in I} \inner{x_i}{x_i} \in A\Big\}
    \]
    It should be noticed that the convergence of $\sum_i \inner{x_i}{x_i}$ is a weaker condition than requiring that the series of norms $\sum_i \big\|\inner{x_i}{x_i}\|$ should converge. With the addition inner product $\inner xy = \sum_{i} \sub{\inner{x_i}{y_i}}{E_i}$, $\bigoplus_{i} E_i$ is a Hilbert $C^*$-module.
%   \begin{enumerate}
%       \item \textbf{\ensuremath{\boldsymbol{\inner\come\come}} is well defined}: Let $x,y \in \bigoplus_i E_i$ and $a,b\in A$ their sums. Therefore, for a given $\ep>0$, we're abble to find finite sets $F_x, F_y \subset J$ such that:
%        \begin{eqspaced*}{\left(\begin{array}{c}
%             F_x\subset I_x \subset I \\
%             F_y\subset I_y \subset I
%        \end{array}\right)}
%        \hspace{-1.25cm}
%        \Big\| \bilateral{-0.18cm}{\sum_{i\in I_x \backslash F_x}} \inner{x_i}{x_i}\Big\| < \ep \e
%        \Big\|\bilateral{-0.18cm}{\sum_{i\in I_y\backslash F_y}} \inner{y_i}{y_i}\Big\| < \ep 
%        \end{eqspaced*}
%        Therefore, for any index set $J$ such that $I \supset J \supset F_x\cup F_y$, one does indeed have that:
%        \begin{eqspaced*}{}
%        \Big\| {\sum_{i\in J \backslash F_x\cup F_y}} \inner{x_i}{y_i} \Big\| \leqslant \Big\|\sum_{i\in J \backslash F_x} \inner{x_i}{x_i}\Big\| \cdot \Big\|\sum_{i\in J \backslash F_y} \inner{y_i}{y_i}\Big\| < \ep^2.
%        \end{eqspaced*}
%        \item \textbf{\ensuremath{\boldsymbol{\bigoplus_i E_i}} is complete}: For a sequence $(x^{(n)})_{n\in \N} \subset \bigoplus_i E_i$ be a Cauchy one, it really means that: For a given $\ep>0$, there exists $n(\ep)\in \N$ such that
%        \begin{eqspaced*}{(n,m \geq n(\ep))}
%        \Big\|\sum_{i\in I} \inner{x_i^{(n)}-x_i^{(m)}}{x_i^{(n)}-x_i^{(m)}} \Big\| < \ep
%        \end{eqspaced*}
%        Since all elements are positive, $\|\inner{x_i^{(n)}-x_i^{(m)}}{x_i^{(n)}-x_i^{(m)}}\| < \ep$ for each and every index $i$. No surprises in noticing that each $(x_i^{(n)})_{n\in \N} \subset E_i$ is a Cauchy sequence inside a Banach space, i.e. there exists $x_i \coloneqq \lim_{n\to \infty} x_i^{(n)}$.
        
%        We must verify that $\sum_i \inner{x_i}{x_i}$ does in fact converge in $A$. Fixing $\ep$ once and for all, get yourself a finite index set $F \subset I$ such that 
%        \begin{eqspaced*}{(F\subset J \subset I)}
%        \Big\| \bilateral{-0.13cm}{\sum_{i\in J \backslash F}} \inner{x_i^{(n)}}{x_i^{(n)}}\Big\| < \ep
%        \end{eqspaced*}
%        for every $n\geqslant n(\ep)$. Notation will be really awfull, so don't freak out: Notice that for a finite intermediary index set $J \supset F' \supset F$, we shall apply the some old trick:
%        \begin{equation*}
%            \begin{array}{rl}
%                 & \Big\| \sum\limits_{i\in F'\backslash F} \Big(\langle x_{i}^{(m)}, x_{i}^{(m)}\rangle+\langle x_{i}^{(n)}-x_{i}^{(m)}, x_{i}^{(m)}\rangle+\langle x_{i}^{(m)}, x_{i}^{(n)}-x_{i}^{(m)}\rangle+\langle x_{i}^{(n)}, x_{i}^{(n)}\rangle\Big) \Big\|\\
%                = & \Big\| \sum\limits_{i\in F'\backslash F} \inner{x_i^{(n)}-x_i^{(m)}}{x_i^{(n)}-x_i^{(m)}} \Big\| \leqslant \Big\| \sum\limits_{i\in I} \inner{x_i^{(n)}-x_i^{(m)}}{x_i^{(n)}-x_i^{(m)}}\Big\| < \ep 
%            \end{array}
%        \end{equation*}
%        Therefore:
%        \begin{equation*}
%            \begin{aligned}
%\Big\|\sum\limits_{i \in F' \backslash F}\langle x_{i}^{(m)}, x_{i}^{(m)}\rangle\Big\| &< 2 \varepsilon+\Big\|\sum\limits_{i \in F' \backslash F}\langle x_{i}^{(n)}-x_{i}^{(m)}, x_{i}^{(m)}\rangle\Big\|+\Big\|\sum\limits_{i \in F' \backslash F}\langle x_{i}^{(m)}, x_{i}^{(n)}-x_{i}^{(m)}\rangle\Big\|\\
%& \leq 2 \varepsilon+2\Big\|\sum\limits_{i \in F' \backslash F}\langle x_{i}^{(n)}-x_{i}^{(m)}, x_{i}^{(n)}-x_{i}^{(m)}\rangle\Big\|^{1 / 2}\Big\|\langle x_{i}^{(m)}, x_{i}^{(m)}\rangle\Big\|^{1 / 2} \\
%& \leq 2 \varepsilon+2 \varepsilon^{1 / 2}\Big\|\langle x_{i}^{(m)}, x_{i}^{(m)}\rangle\Big\|^{1 / 2} .
%\end{aligned}
%        \end{equation*}
%        Now, by solving the quadratic inequality, we obtain that
%$$
%\left\|\sum\limits_{i\in J\backslash F}\left\langle x_{i}^{(m)}, x_{i}^{(m)}\right\rangle\right\|<(1+\sqrt{3})^{2} \varepsilon<8 \varepsilon .
%$$
%Passing to the limit $m \longrightarrow \infty$ in the inequality above, we obtain that
%$$
%\left\|\sum\limits_{i\in J\backslash F}\left\langle x_{i}, x_{i}\right\rangle\right\|<8 \varepsilon
%$$
%    \end{enumerate}    
    \item Subexamples of \ref{item: soma direta de modulos de hilbert} are: $A$ it self endowed with $\inner ab \coloneqq a^*b$; $A^n = \bigoplus_{i =1}^n A$ for any natural number $n$.
    
    \item \textbf{The standard Hilbert \mathbf{A}-module $\boldsymbol{\HA}$}: Another subexample of \ref{item: soma direta de modulos de hilbert} can be given by $\HA \coloneqq \bigoplus_{n\in \mathbb N} A$, consisting of all sequences $(a_n)_n \subset A$ which $\sum_n a_n^*a_n$ converges.
    \item \label{exemplo hilb (X) C*algebra} Given a Hilbert space $H$, the algebraic tensor product of $H$ by $A$ can be seen as an inner product $C^*$-module, with the bond:
    \[
    \inner {x\otimes a}{y\otimes b} \coloneqq \sub{\inner xy}H a^*b
    \]
    $H\otimes A$ stands for its completion.
    
    \item Let $X \in \CHaus$ and $E\longto X$ a complex vector bundle. As we mention, $C(X)$ is a unital $C^*$-algebra. Whenever $d: E\times E \longto [0,\infty)$ is an Hermitian metric over $E$, the set $\Gamma (E)$ of continuous sections over $E$ holds the title of Hilbert module over $C(X)$ when endowed with
    \begin{equation*}
    \function{{\inner\come\come}{\Gamma(E)\times \Gamma(E)}{C(X)}{(a,b)}{d(a(\,\cdot\,),b(\,\cdot\,))}} 
    \end{equation*}
    as an inner product.

%    \item Let $G$ be a locally compact group and consider the integral of $f: G \longto \C$ with respect to the left Haar measure. With the involution
\end{itroman}
\end{exemplos}
%\begin{itroman}
%
%\end{itroman}

\begin{lema}
\label{lema: lim <x_lambda,y_lambda> = <x,y>}
Given two nets $(\sub x\lambda)_\lambda$ and $(\sub y\lambda)_\lambda$ and $x,y$ in a Hilbert module $E$ over a $C^*$-algebra $A$ such that $\sub x\lambda \to x$ and $\sub y\lambda \to y$,  $\lim_\lambda \inner{\sub x\lambda}{\sub y\lambda} = \inner xy$ holds.
\begin{proof}
From the Cauchy-Schartz inequality \ref{prop: Cauchy-Schwartz}, is easy to obtain that
\begin{eqspaced*}{(z\in E, \lambda \in \LLambda)}
    \sub{\|\inner{\sub x\lambda-x}z\|}A \overset{(\ref{eq: cauchy-schwarts})}\leqslant \sub{\|\sub x\lambda-x\|}E \sub{\|z\|}E
\end{eqspaced*}
Analogously, $\sub{\|\inner z{\sub y\lambda-y}\|}A \leqslant \sub{\|\sub y\lambda-y\|}E \sub{\|z\|}E$. For each and every index $\lambda$, it is possible to obtain the following inequality:
\begin{eqnarray*}
    \|\inner{\sub x\lambda}{\sub y\lambda} - \inner xy\| &=& \|\inner{\sub x\lambda}{\sub y\lambda} - \inner{\sub x\lambda}y + \inner{\sub x\lambda}y- \inner xy\|  \\
    &\leqslant& \|\inner{\sub x\lambda}{\sub y\lambda-y}\| + \| \inner{\sub x\lambda-x}y\| \\
    &\leqslant& \|\sub y\lambda-y\| \|\sub x\lambda\| +\|y\|\|\sub x\lambda-x\| 
\end{eqnarray*}
Let $\ep > 0$. Notice that $\sub x\lambda \to x$, means that $\|\sub x\lambda\| \to \|x\|$. By $\|\sub y\lambda -y\|\to 0$,  there exists $\sub\lambda 0$ in which $\|\sub y\lambda - y\|\,\|\sub x\lambda\|  < \ep/2 $. Similarly, there always exists $\sub\lambda1$ such that $\sub{\|\sub x\lambda -x\|}E < \ep/2({\|y\|}+1)$ for $\lambda \succeq \sub\lambda1$. Since it exists $\sub\lambda2 $ such that $\sub\lambda2 \succeq \sub\lambda0$ and $\sub\lambda2 \succeq \sub\lambda1$, we conclude that $\|\inner{\sub x\lambda}{\sub y\lambda} - \inner xy\| < \ep$ for all scalars $\lambda \succeq \sub\lambda2$.
\end{proof}
\end{lema}


%\begin{proposicao}
%If $E$ is Hilbert $A$-module, $\|x\| = \sup\{\|\inner xy\| \mid \|y\| \leq 1\}$.
%\end{proposicao}

\section{Adjointable operators}
%- no riesz lemma :/
%- examples of non-adjointables
%- the (unital) C*-algebra of adjointable operators
%- equivalence of positivity

\begin{definicao}
    Let $E, F$ be Hilbert modules over a $C^*$-algebra $A$. A function $T:E\longto F$ is said to be \textit{adjointable} if there exists a function $T^*: F\longto E$ which satisfies the following relation:
    \begin{eqspaced*}{((x,y) \in E \times F)}
    \sub{\inner {Tx}y}F = \sub{\inner x{T^*y}}E
    \end{eqspaced*}
    Besides talking about Hilbert modules, we had defined the adjoint concept for any function between Hilbert modules. That's because inner product relations naturally require these functions to be linear operators, and if they exist, the adjoint is unique. For an adjointable $T$, $T^*$ is unique, adjointable and $T^{**} = T$. Moreover, $(ST)^* = T^*S^*$ for adjointable operators $T$ and $S$.
\end{definicao}
    
\begin{proposicao}
    Every adjointable operator $T:E \longto F$, between Hilbert $A$-modules is bounded and continuous.
     \begin{proof}
         Since the set $\{\sub{\inner{Tx}y}F = \sub{\inner{x}{T^*y}}E \mid \|x\|\leq 1\} \subset A$ is bounded for all $y \in F$, Banach-Steinhaus theorem \ref{invo: limitacao uniforme} implies that $T$ is a bounded linear operators between normed spaces, i.e. it is continuous. \qedhere
         \begin{quote}
             \begin{invocacao}[Banach-Steinhaus ``Uniform Boundness Principle'' - \cite{sokal2011uniform}]
         \label{invo: limitacao uniforme}
         Let $\mathcal{F}$ be a family of bounded linear operators from a Banach space $X$ to a normed linear space $Y$. If $\mathcal{F}$ is pointwise bounded, then $\mathcal{F}$ is norm-bounded, i.e.

        %  \[\forall\,x\in X, \displaystyle \sup _{T \in \mathcal{F}}\|T x\|<\infty \To \sup _{T \in \mathcal{F}}\|T\|<\infty.\]
         $\hphantom{\text{pointw}}\vphantom{\int\limits^\int}\forall\,x\in X, \displaystyle \sup _{T \in \mathcal{F}}\|T x\|<\infty \To \sup _{T \in \mathcal{F}}\|T\|<\infty.$
        % \textit{A sketch of Sokal's really simple proof}. For any operator $T\in \mathcal F$, one obtain that\footnote{Just observe that 
        % \[\max(\|T(x+\xi)\|, \|T(x-\xi)\|) \geqslant \dfrac{1}{2}(\|T(x+\xi)\|+ \|T(x-\xi)\|) \geq \|T\xi\|\]
        % foll all $\xi \in X$. Hence, take the supremum over $\xi \in B(0,r)$.} $\sup_{z\in B(x,r)} \|Tz\| \geqslant \|T\|r$ for any $x\in X$ and $r>0$. Hence, if $\sup \|\mathcal F\| = \infty$, there exists a sequence $(T_n)_n\subset \mathcal{F}$ such that $\|T_n\| \geqslant 4^n$. By the first claim, one can build (inductively) $(x_n)_n\subset X$, with $\sub x0=0$, $\|x_{n+1}-x_n\|\leqslant 1/3^{n+1}$ and $\|T_nx\|\geqslant \|T\|2/3^{n+1}$, which happens to be a Cauchy. Since $X$ is complete, there exists $x$ such that $\|x-x_n\| \leq 3^n/2$, hence $\|T_nx\| \geq \|T_n\|/(2.3^n) \geqslant (4/3)^n/2$, contradicting pointwise convergence of $\mathcal F$.
        \end{invocacao}
        \end{quote}
        % By \ref{lema: lim <x_lambda,y_lambda> = <x,y>}, for a convergent net $\sub x\lambda \to x$, the following holds for all $y\in E$:
        % \begin{equation*}{}
        % \begin{array}{rcl}
        % 0 &=& \lim_\lambda \Big[\inner{T^*y}{\sub x\lambda} - \inner{T^*y}{\sub x\lambda}\Big]\\
        % &=& \vphantom{\int\limits_a^b}\lim_\lambda \inner{y}{T\sub x\lambda} - \lim_\lambda\inner{T^*y}{\sub x\lambda} \\
        % &=& \inner{y}{\textstyle{\lim_\lambda T\sub x\lambda}} - \inner{T^*y}{{\textstyle\lim_\lambda \sub x\lambda}} \\
        % &=& \vphantom{\int\limits_a^b}\inner{y}{{\textstyle\lim_\lambda T\sub x\lambda}} - \inner{T^*y}x\\
        % &=& \inner{y}{{\textstyle\lim_\lambda T\sub x\lambda}} - \inner{y}{Tx} = \inner{y}{\lim_\lambda T\sub x\lambda - Tx}
        % \end{array}
        % \end{equation*}
        % Especially when $y \coloneqq \lim_\lambda T\sub x\lambda  - Tx$, so that $\lim_\lambda T\sub x\lambda = Tx$.
     \end{proof}
\end{proposicao}
    
\begin{exemplo}
    \label{exemplo:finite rank}
    Given $x,y \in E$, the maps $y\inner{x}{\come}$ and $x\inner y\come$ are adjoints of each other. The linear span of those operator are what we will call the \textit{finite rank} operators.
\end{exemplo}
    
In traditional Hilbert spaces, every bounded operator is adjointable, thanks to the Riesz Lemma (\cite[Theorem II.4]{reed2012methods}). But when talking about Hilbert modules, that might not be the case anymore:
    
\begin{contraexemplo}[\textit{Non-adjointable bounded operator}] \label{contraexemplo: paschke non adjointable}
    This one can be founded in \textsc{W. Paschke}'s work \cite[Remark 2.5]{paschke1973inner}. Suppose that $J$ is a closed right ideal of a unital $C^{*}$-algebra $A$ such that no element of $J^{*}$ acts as a left multiplicative identity on $J$\footnote{For instance, the algebra of complex valued continuous functions on the unit interval $C[0,1]$, and the ideal $\sub C0[0,1]$ of functions which vanish at 0.}. Consider the right module $J \times A$ with inner product defined by 
    \begin{equation*}
    \inner{\left(\sub a{1}, \sub b{1}\right)}{\left(\sub a{2}, \sub b{2}\right)} = \sub a{2}^{*} \sub a{1}+\sub b{2}^{*} \sub b{1}
    \end{equation*}
    for $\sub a1, \sub a2 \in J$ and $\sub b1, \sub b2 \in A$. In this new space we have $\sub{\|(a, b)\|}{J\times A}^2=\left\|a^{*} a+b^* b\right\|\leq \|a\|^{2}+\|b\|^{2}$, hence $\sub{\|\come\|}{J\times A}$ is complete, i.e. $J\times A$ is a Hilbert module. 
    
    The operator $T(a,b)\coloneqq (0,a)$ for each $(a,b) \in J\times A$ is obviously a bounded one, but if we suppose that there exists $T^*$ and let $(x,y) \coloneqq T^*(0,1)$, notice that
    \begin{equation*}
        a = \inner{T(a,b)}{(0,1)} = \inner{(a,b)}{T^*(0,1)} = x^*a+y^*b
    \end{equation*}
    for all $(a,b)$. Necessarily, it is the case that $y=0$ and $x^*a=a$ for all $a\in J$, hence $x^*$ acts as a left multiplicative identity on $J$. But $x^* \in J^*$, and this contradicts our assumption of $J$.
\end{contraexemplo}
    
\begin{contraexemplo}
    Let $X$ be a compact Hausdorff space and $Y \subset X$ a closed non-empty subset with dense complement. Let $E \coloneqq \big\{f \in C(X) \mid f(Y) = \{0\}\big\}$ and $\iota : E \longhookrightarrow C(X)$ the bounded inclusion map. If $\iota$ were adjointable, $E \ni \iota^*(\sub\Id{C(X)}) = \sub\Id{C(X)} \notin E$, i.e. the inclusion is a non-adjointable bounded operator.
\end{contraexemplo}
        
\begin{proposicao}
    With the operator norm $\|T\| \coloneqq \sup_{\|x\|=1} \|Tx\|$, the adjointable operators $\adj(E,F)$ is $C^*$-algebra.
    \begin{proof}
    It is straight foward checking that $\adj(E,F)$ is a Banach algebra with an involution. To check the $C^*$-norm property, for each adjointable $T$,
    \begin{equation}
    \label{eq: |Tx|² <= |T*|.|T|.|x|²}
        \begin{array}{rcl}
            \|Tx\|^2 &=& \|\inner{Tx}{Tx}\| = \|\inner{T^*Tx}{x}\| \overset{\ref{prop: Cauchy-Schwartz}}\leq \|T^*Tx\|\|x\| \\
            &\leq & \|T^*T\|\|x\|^2 \leq \|T^*\|\|T\| \|x\|^2 
        \end{array}
    \end{equation}
    for all $x\in E$. A direct calculation using (\ref{eq: |Tx|² <= |T*|.|T|.|x|²}), shows that
    \[
    \|T\|^2 = \sup_{\|x\|=1} \|Tx\|^2 \leq \sup_{\|x\|=1} \|T^*\|\|T\|\|x\|^2 = \|T^*\|\|T\|,
    \]
    which means: $\|T\| \leq \|T^*\|$ and by extension, $\|T\|=\|T^*\|$. This automatically guarantee the $C^*$-norm property.
    \end{proof}
\end{proposicao}
    
\begin{proposicao}[Equivalence of positivity]
    Let $T\in \adj(E)$. For $T$ to be positive in the $C^*$-algebra $\adj(E)$ is equivalent to being positive in the scalars coefficients algebra: $\inner{Tx}{x} \geq 0$ for all $x\in E$.
    \begin{proof}
    Assume that $T$ is a positive element in the $C^*$-algebra of operators. In a $C^*$-algebra, we know that $a \geqslant 0 \sse a=b^*b$ for some $b$. With this in hands, let $S$ be such that $T = S^*S$. Therefore:
    \begin{eqspaced}{(x\in E)}
    \inner{Tx}x = \inner{S^*Sx}{x} = \inner{Sx}{Sx} \bilateral{-0.25cm}{\overset{\ref{def: pre-hilb module}\ref{def item: positivo definido}}\geq} 0.
    \end{eqspaced}
    Conversely, positive elements are self-adjoint, i.e. $\inner{Tx}x = \inner{x}{Tx}$. From the polarization identity \ref{eq: polarization}, one can see that $\inner{Tx}y = \inner{x}{Ty}$ for all $x,y \in E$, showing that $T$ is self-adjoint. By the Hahn decomposition\footnote{Every element $a\in A$ in a $C^*$-algebra can be written as $a = a_+-a_-$ with $a_+, a_-\geqslant 0$, $a_+a_-=a_-a_+=0$. This is called the Hahn decomposition.}, there exists two positive elements $T_+$ and $T_-$ such that $T = T_+-T_-$ and $T_+T_-= T_-T_+ = 0$. Then $\langle T_{-} y, y\rangle \leq\langle T_{+} y, y\rangle$ for any $y \in E$. In particular,
    $$
    \langle T_{-}^{3} x, x\rangle=\langle T_{-}^{2} x, T_{-} x\rangle \leq\langle T_{+} T_{-} x, T_{-} x\rangle=0 .
    $$
    On the other hand, $T_{-} \geq 0$ and $T_{-}^{3} \geq 0$, hence $\langle T_{-}^{3} x, x\rangle \geq 0$ (because the statement in this direction is already proved). So the only possibility left is $\langle T_{-}^{3} x, x\rangle=0$ for any $x $. By the polarization equality \ref{eq: polarization}, this implies $\langle T_{-}^{3} x, y\rangle=0$ for all $x, y \in \mathcal{M}$, hence $T_{-}^{3}=0$, $T_{-}=0$. Thus, $T=T_{+} \geq 0$.
    \end{proof}
\end{proposicao}
    
\begin{proposicao}
    If $T \in \adj(E,F)$ and $x\in E$, then $\inner{Tx}{Tx} \leqslant \|T\|^2 \inner xx$.
    \begin{proof}
    Let $\rho$ be a state of $A$. By repeated application of the Cauchy-Schwartz inequality to $\rho(\inner\come\come)$:
    \begin{eqnarray*}
    \rho(\inner{T^*Tx}{x}) &\leq& \rho\big(\inner{T^*Tx}{T^*Tx}\big)^{\frac12} \rho\big(\inner xx\big)^{\frac12} \\
    &=&
    \rho\big(\inner{(T^*T)^2x}{x}\big)^{\frac12} \rho\big(\inner xx\big)^{\frac12} \\
    &\leq& 
    \rho\big(\inner{(T^*T)^4x}{x}\big)^{\frac14} \rho\big(\inner xx\big)^{\frac12 + \frac14} \\
    &\vdots&  \\
    &\leq& 
    \rho\big(\inner{(T^*T)^{2^n}x}{x}\big)^{\frac1{2^n}} \rho\big(\inner xx\big)^{\frac12 + \frac14+ \cdots + \frac1{2^n}} \\
    &\leq& 
    \|x\|^{2^{1-n}} \|T^*T\| \rho\big(\inner xx\big)^{1 - \frac1{2^n}} 
    \end{eqnarray*}
    As $n\to \infty$, one deduces that $\rho(\inner{Tx}{Tx}) \leqslant \|T\|^2 \rho(\inner xx)$. Since this is true for all states $\rho$, the desired inequality holds.
    \end{proof}
\end{proposicao}
    
\section{Compact and Finite rank operators}
\label{sec: finite rank operators}

We are heading towards the definition of generalized Fredholm operators between Hilbert modules, and for that, we need a replacement for the finite dimensional condition. Henceforth, we shall explore the example \ref{exemplo:finite rank}.

Let $E$ be a Hilbert $A$-module. Consider the following operator:
\begin{equation}
    \function{{\Omega}{E^n}{\adj(A^n,E)}{(x_i)_i}{\Big((a_i)_i
    \overset{\Omega_x}\longmapsto \sum\limits_{i=1}^n x_ia_i\Big)}}
\end{equation}
In order to obtain the adjoint operator, as far as algebraic manipulation goes, $\Omega_x^*: E \longto A^n$ has no other option else besides being the coordinate inner decomposition $(\inner{x_i}{\come})_i$: For $a \in A^n$ and $\xi \in E$,
\begin{eqspaced*}{}
    \begin{array}{rcl}
         \sub{\inner{\Omega_x a}{\xi}}E  &=& \displaystyle \Big\langle\sum\limits_{i=1}^n x_ia_i, \xi \Big\rangle_M \\
         &=& \vphantom{\displaystyle \int\limits^a} \displaystyle \sum\limits_{i=1}^n a_i^*\sub{\inner{x_i}\xi}E \\
         &=& \left[\begin{matrix}
    \sub a1^* & \cdots & a_n^*
    \end{matrix}\right] \left[\begin{matrix}
    \sub{\inner{\sub x1}\xi}E \\ \vdots \\ \sub{\inner{x_n}\xi}E
    \end{matrix}\right] \\
    &=& \vphantom{\displaystyle\int^{\int}} {\Big\langle {a}, {\left(\sub{\inner{\sub x1}\xi}E,\ldots, \sub{\inner{x_n}\xi}E\right) }\Big\rangle }_{A^n} = \sub{\inner{a}{\Omega_x^*\xi}}{A^n}
    \end{array}
\end{eqspaced*}

If $F$ is another Hilbert $A$-module and $n\in \N$, one should note that for $x\in E^n$ and $y \in F^n$, $\Omega_y\Omega_x^*$ rises a fair notion of \textit{finite rank}, since their range elements are given by
\begin{eqspaced}{}
\label{eq: omega_y omega_x*}
    \Omega_y\Omega_x^*\xi = \Omega_y^n\left(\sub{\inner{\sub x1}\xi}E,\ldots, \sub{\inner{x_n}\xi}E\right)= {\sum\limits_{i=1}^n} y_i \sub{\inner{x_i}\xi}E.
\end{eqspaced}

\begin{definicao}[Compact and finite-rank operators]
Every operator of the form $\Omega_y\Omega_x^*: E\longto F$, where $(x,y) \in E^n \times F^n$ will be said to be an $A$\textit{-finite rank operator}. The set of finite-rank operators will be denoted by $\sub{\textsc{FR}}{A}(E,F)$. The set of $A$\textit{-compact operators} between $E$ and $F$ are defined as the topological closure of the subspace $\sub{\textsc{FR}}A(E,F) \subset \adj(E,F)$ and it is denoted as $\sub{\mathscr K}A(E,F)$. 
\end{definicao}

Unfortunately, $A$-compact operators need not to be compact in the sense of Banach spaces:

\begin{contraexemplo}
In a unital $C^*$-algebra $A$, the identity can be viewed as $\Omega_1 \Omega_1^* = \sub \Id A$ on the Hilbert module $A$. Hence $\sub \Id A \in \mathscr K(A)$, but it is a compact operator on the Banach space $A$ if and only if $A$ is finite-dimensional, since it is an invertible compact\footnote{If $T:X\longto Y$ is an invertible compact operator between Banach spaces in the classical sense, the boundness of $\inv T$ rises a constant $C$ such that $\|\inv Ty\| \leqslant C\|y\|$, and by invertibility, $\|x\|\leqslant C\|Tx\|$. Thus, the image by $T$ of the unit ball in $X$ contains an open ball in $Y$. Since $T$ is compact, $Y$ is
finite-dimensional, and so do $X$.}. 
\end{contraexemplo}

%\begin{proposicao}[Riesz's representation analog theorem]
%For a Hilbert $A$-module $E$, let $T \in \mathscr K(E,A)$ be a $A$-compact operator between $A$-modules. Then there is an element $x\in E$ such that $T = \inner{x}{\come}$.
%\end{proposicao}\begin{proof}
%\textcolor{red}{ESTUDAR}
%Suppose that $T\neq 0$ and notice that $\ker T$ is a proper closed subspace. From the orthogonal decompositon, $E = \ker T \oplus \ker T^{\perp}$. By Riez lemma, there exists $z\in \ker T^{\perp}$ with $\|z\|=1$. Since $T((Ty)z-(Tz)y) = 0$, one obtains that
%\begin{eqspaced}{(y\in E)}
%\inner z{z(Ty)-y(Tz)} = 0
%\end{eqspaced}
%i.e. $Ty = \inner{(Tz)^*z}{y}$.
%\end{proof}

\begin{proposicao}\label{prop: H_A resgata nocao de compacto}
In the standard Hilbert module $\HA$ over a unital $C^*$-algebra $A$, the classical compact notion of compact operator is well rescued: If $E_n \subset \HA$ denotes the free submodule generated by the first $n$ canonical elements $\sub e0, \sub e1, \ldots, e_{n-1}$, the following are equivalent:
\begin{itroman}
    \item\label{prop item: prop: H_A resgata nocao de compacto (i)} $K \in \mathscr K_{A}(\HA)$.
    \item\label{prop item: prop: H_A resgata nocao de compacto (ii)} The norms of restrictions of $K$ onto the orthogonal complements $E_n^{\perp}$ of the submodules $E_n$ vanish as $n \longrightarrow \infty$.
\end{itroman}
\begin{proof}
$\left.\right.$
\begin{itemize}
    \item[$\ref{prop item: prop: H_A resgata nocao de compacto (i)} \Rightarrow \ref{prop item: prop: H_A resgata nocao de compacto (ii)}$] Let $n\in \N$ and $p_{n}: \HA \longtwoheadrightarrow E_n^\perp$ be the orthogonal projection and consider some finite rank operator $\Omega_y^{\vphantom{*}}\Omega_x^*$ for $x,y \in \HA^n$. Then, for any $z \perp E_n$, one has
    \begin{eqspaced*}{}
    \begin{array}{rcl}
\|\Omega_y^{\vphantom{*}}\Omega_x^*z\|^{2} &= & \vphantom{\int\limits_b} \|\langle\Omega_{y}^{\vphantom{*}}\Omega_{x}^{*}z, \Omega_{y}^{}\Omega_x^{*}z\rangle\|\\
&=& \big\| \big\langle y\langle x,z\rangle, y\langle x,z\rangle\big\rangle\big\| \\
&=& \vphantom{\int\limits_b^a} \|\langle x, z\rangle^{*}\langle y, y\rangle\langle x, z\rangle\| \\
& \leq& \|y\|^{2}\|\langle x, z\rangle\|^{2}
\\
&=& \vphantom{\int\limits_b^a}\|y\|^{2}\,\|\langle p_{n} x, z\rangle\|^{2} \\
& \leq& \|y\|^{2} \,\|p_{n} x\|^{2} \,\|z\|^{2} .
\end{array}
    \end{eqspaced*}
Since $\|p_{n} x\|$ tends to zero, the same is true for the norm of the restriction of the operator $\Omega_{y}^{}\Omega_{x}^{*}$ to the submodule $E_n^{\perp}$, hence, for the norm of any compact operator $K$.
    \item[$\ref{prop item: prop: H_A resgata nocao de compacto (i)} \Leftarrow \ref{prop item: prop: H_A resgata nocao de compacto (ii)}$] For a operator $K \in \adj(\HA)$, suppose that $\|K \sub\restrita{E_n^{\perp}}\|$ vanishes when $n\to \infty$. If $z$ is an orthogonal element with respect to $E_n$, i.e. $\inner{e_i}{z} =0$ for any $i \leq n$, notice that if $e^n\coloneqq (\sub e1, \ldots, e_n)$, then $\Omega_{Ke^n}^{\vphantom{*}}\Omega_{e^n}^*(z)= 0$. Therefore:
    \begin{equation*}
        \begin{array}{rl}
            & \lim\limits_{n\to \infty} \sup\limits_{\substack{ z \in E_n^{\perp} \\ \|z\| \leq 1}} \Big\| Kz - \sum\limits_{i=1}^n Ke_i \inner{e_i}z\Big\|\\
            = &  
        \lim\limits_{n\to \infty} \sup\limits_{\substack{ z \in E_n^{\perp} \\ \|z\| \leq 1}} \| Kz \| = \lim\limits_{n\to \infty} \|K \sub\restrita{E_n^{\perp}}\|= 0.
        \end{array}
    \end{equation*}
    If $z \in E_n$, one can see that $Kz = \Omega_{Ke^n}^{\vphantom{*}}\Omega_{e^n}^*(z)$, so that the supreme can be taken in the hole $\HA$. Therefore:
    \begin{equation*}
        K = \lim_{n\to \infty} \sum_{i=1}^n \Omega_{Ke_i}^{\vphantom{*}}\Omega_{e_i}^* \in \mathscr K_A(\HA). \qedhere 
    \end{equation*}
\end{itemize}
\end{proof}
\end{proposicao}

%\begin{exemplo}
%For any traditional complex Hilbert space $H$, $\sub{\mathscr K}{\C}(H)$ is the usual compact set of operators: Given $K: H \longto H$ such that $K = \lim_\lambda \Omega_{\sub w\lambda}\Omega_{\sub z\lambda}^*$ for some $(\sub z\lambda)_\lambda,(\sub w\lambda)_\lambda \subset \C^n$, let $B$ be the closed unit ball.

%\textcolor{red}{We seek to show that $\con{K(B)}$ is a compact set.}
%\end{exemplo}

\begin{exemplos}$\left.\right.$
    \label{exemplos: K( . )}
\begin{itroman}
    \item Let $A$ be your favorite $C^*$-algebra. We shall see that $\mathscr K(A) \simeq A$. Notice that the map 
    \begin{equation*}
        \function{{L}{A}{\adj(A)}{a}{
            (b \overset{L_a}\longmapsto ab)}}
    \end{equation*}
    is well defined since $L_{a^*}$ is the adjoint of $L_a$. It is no mistery that $\|L_a\| \leqslant \|a\|$, but notice that $\|L_a(a^*)\| = \|a\|\,\|a^*\|$, hence $L$ is an isomorphism of $A$ onto a closed $*$-subalgebra of $\adj(A)$. \nocite{raeburn1998morita}
    
    Since $a\inner{b}{\come} = L_{ab^*}$, it follows that $\mathscr K(A)$ is the closure of (the image under $L$ of) the linear span of products in $A$. But, since every $C^*$-algebra contains an approximate identity, the products above are dense, thus $L$ is an isomorphism between $A$ and $\mathscr K(A)$.   

    \item \label{exemplo item: K(A)=L(A) pra A unital} If $A$ is a unital algebra, $\mathscr K(A) = \adj(A)$ since any adjointable operator $T$ consists of left multiplication by $T(1)$.
    
    \item Reviewing \ref{exemplos de hilbert modules}\ref{exemplo hilb (X) C*algebra}, one can obtain that $\mathscr K(H\otimes A) \simeq \mathscr K(H) \otimes A$. 
    
    \item $\mathscr K(E^m, F^n) \simeq \mathbb M_{m\times n}(\mathscr K(E, F))$ and $\mathscr L(E^m, F^n) \simeq \mathbb M_{m\times n}(\mathscr L(E, F))$.
    
%    \item \textbf{Hilbert modules which all bounded operators are adjointable}: Let $\mathcal K$ be the $C^*$-algebra of all compact operators in a Hilbert space. If $E$ is a Hilbert $\mathcal K$-module, by ???, each bounded linear operator $T: E \longto E$ is adjointable.
%    \textcolor{red}{Pesquisar melhor: \url{https://arxiv.org/pdf/math/0611916.pdf}, \url{http://pub.acta.hu/acta/showCustomerArticle.action?id=2821&dataObjectType=article&returnAction=showCustomerVolume&sessionDataSetId=721f203e8ce1a16e&style=}}
\end{itroman}
\end{exemplos}

\begin{proposicao}\label{prop: Omega_x eh compacto}
For each $x\in E^n$, $\Omega_x$ is an $A$-compact operator.
\begin{proof}
Let $(\sub u\lambda)_\lambda \subset A$ be an approximate unit. Considering $A$ it self as a Hilbert $C^*$-module, $\Omega_{\sub u\lambda}^* : A^1\longto A$ is the standard multiplication by $\sub u\lambda$. Therefore, for each $a\in A$, we obtain the desired relation for $n=1$:
\begin{eqspaced}{}
\label{eq: 1-rank multipliers are compact}
    \begin{array}{rcl}
        \Omega_xa &=& xa = x \lim_\lambda \sub u\lambda a \\
        &\overset{\sub u\lambda= \sub u\lambda^*}=& \lim_\lambda x \sub{\inner{\sub u\lambda}{a}}A \overset{(\ref{eq: omega_y omega_x*})}= \lim_\lambda \Omega_x {\Omega_{\sub u\lambda}}^{\hspace{-0.15cm}*}a  
    \end{array}
\end{eqspaced}
For a general $n$, we arrive at a sum of finite 1-rank operators. Given $x \in E^n$ and $a \in A^n $, for each $\lambda$, we wish to obtain $y\in E^n$ and $b\in (A^n)^n$ such that, 
\[
\sum_{i=1}^n \Omega_{x_i} \Omega_{\sub u\lambda}^*a_i \overset{(*)}= \Omega_{y} \Omega_{b}^* a
\]
in order to write a general $\Omega_x$ as a compact operator. To address $(*)$, let $y\coloneqq x$ and $b \coloneqq \operatorname{Diag}(\sub u\lambda) \in \mathbb M_{n\times n}(A) \simeq (A^n)^n$ the diagonal matrix whose non zero entries are $\sub u\lambda$. Notice that
\begin{eqspaced}{(a\in A^n)}
\label{eq: Omega_xOmega_ulambda^* da certo}
\begin{array}{rcl}
     \Omega_{y} \Omega_{b}^* a &=&  \Omega_x \Omega_{\operatorname{Diag}(\sub u\lambda)}^*a \\
     &=& \displaystyle \sum\limits_{i=1}^n x_i \hspace{-0.3cm} \underbrace{\sub{\inner{b_i}{a}}{A^n}}_{\sum\limits_{j=1}^n \sub{\inner{b_{ij}}{a_j}}{A}}\\
     &=& \displaystyle \sum\limits_{i=1}^n x_i \inner{b_{ii}}{a_i}\sub{\,}{A} \\ 
     &\overset{\sub u\lambda = b_{ii}}=& \displaystyle \sum_{i=1}^n \Omega_{x_i} \Omega_{\sub u\lambda}^*a_i
\end{array}
\end{eqspaced}
Therefore, for any $a\in A^n$, the following holds and the claim is proved. 
\begin{equation*}
    \Omega_xa = \sum_{i=1}^n x_i a_i \overset{(\ref{eq: 1-rank multipliers are compact})}= \lim_\lambda \sum_{i=1}^n  \Omega_{x_i}\Omega_{\sub u\lambda}^* a_i \overset{(\ref{eq: Omega_xOmega_ulambda^* da certo})}= \lim_\lambda \Omega_x \Omega_{\operatorname{Diag}(\sub u\lambda)}^*a. \qedhere
\end{equation*}
\end{proof}
\end{proposicao}

\begin{definicao}[Finite-rank Hilbert Module]
\label{def: finite rank module}
A Hilbert Module $M$ over an $C^*$-algebra $A$ whose identity operator $\sub\Id M$ is $A$-finite rank will be said to be an $A$\textit{-finite rank} module.
\end{definicao}

\begin{proposicao}\label{prop: FR(M) eh um ideal}
If $E$ is an Hilbert $A$-module, the family of finite rank automorphisms ${\textsc{FR}}(E)$ is a two-sided ideal of $\adj(E)$. 
\begin{proof}
Extending coordinate-wise, let $Ty \coloneqq \coord{Ty}n $ and notice that, for $T,S \in \adj(E)$,
\begin{eqspaced*}{}
    \begin{array}{rcl}
        T\Omega_y\Omega_x^* + \Omega_w\Omega_z^*S &=& \sum\limits_{i=1}^n   Ty_i\inner{x_i}{\,\cdot\,}  + \sum\limits_{j=1}^m w_j\inner{S^*z_j}{\,\cdot\,} \\
        &=& \Omega_{(Ty,w)}^{\vphantom{*}}\Omega_{(x,S^*z)}^*. 
    \end{array}
\end{eqspaced*}
Therefore, any $\adj(E)$-linear combination of finite rank operators is itself a finite rank one, as showed above, i.e. ${\textsc{FR}}(E) \triangleleft \adj(E)$.
\end{proof}
\end{proposicao}

\begin{proposicao}\label{prop: identidade compacta eh de rank finito}
If the identity $\sub\Id E$ in a Hilbert module $E$ is a compact operator, then $E$ has finite rank, i.e. $\sub \Id E \in \mathscr K(E) \Rightarrow \sub\Id E \in \operatorname{FR}(E)$. 
\begin{proof}
Suppose that $\sub\Id E$ is a compact operator in a given Hilbert $C^*$-module $E$. By construction, $\operatorname{FR}(E)$ is a dense subset of compact operators, so every open non-empty set $U \subset \mathscr K({E})$ obeys
\begin{eqspaced*}{(U \subset \mathscr K(E))}
U \cap \operatorname{FR}({E}) \neq \varnothing
\end{eqspaced*}
Since $\mathscr K({E})$ is a unital ${C}^{*}$-algebra, the invertible operators $\mathrm{GL}(\mathscr K({E}))$ constitute a non-empty open set, hence there is a finite-rank invertible operator $F \in \GL(\mathscr K(E)) \cap \operatorname{FR}(E)$. Since $\operatorname{FR}({E})$ contains an invertible and is an ideal, it follows that  $\sub\Id E = F\inv F \in \operatorname{FR}({E})$, i.e. the identity has finite rank.
\end{proof}
\end{proposicao}

In order to fully characterize finite rank Hilbert Modules over a given $C^*$-algebra, the same $K$-theoretic bias is seen right here through the representation by idempotents.
%As far as theory goes, polar decomposition of a given adjointable operator is required. 

%\begin{invocacao}[\cite{liu2019polar}, Theorems 3.8 and 3.13]
%\label{invo: existencia de decomposicao polar}
%Let $T\in \adj(M,N)$ be an adjointable operator between Hilbert modules $M,N$ over a given $C^*$-algebra. If the closed image subspaces $\con{\Im T}$, $\con{\Im T^*}$ are both orthogonally complemented\footnote{$N = \con{\Im T^*} \oplus \con{\Im T^*}^\perp$}, then there is \textit{partial isometry} $U \in \adj(M,N)$ (i.e. $U^*U$ is a projection operator) which satisfies
%\begin{equation}
%\label{eq: T=U|T| e ker T subset ker U}
%    T = U |T| \e \ker T \subset \ker U
%\end{equation}
%and it is the unique polar decomposition of $T$, i.e. %$U^*U$ is the projection over $\con{\Im T^*}$.
%\end{invocacao}

%The hypothesis of $\con{\Im T^*}$ beeing orthogonally complemented cannot be discarded. Over familiar Hilbert spaces, this is allways the case, which unfortunatelly mustn't be the case at this general view:

%\begin{contraexemplo}[\cite{liu2019polar}]
%We present an adjointable operator $T$ without polar decomposition and a partial isometry who obeys (\ref{eq: T=U|T| e ker T subset ker U}).
%
%Considering $H$ a separable Hilbert, the set $\mathscr B(H)$ of bounded linear automorphisms over $H$ is the prototypical example of $C^*$-algebra, hence a Hilbert module over it self. Given any orthogonal normalized basis $(e_n)_{n\in\N}$ for $H$, let $S\in \mathscr K(H)$ given by $Se_n = e_n/n$ for any natural $n$. The operator we need to care here is given by
%\begin{equation*}
%    \function{T{\mathscr B(H)}{\mathscr B(H)}{X}{SX}}
%\end{equation*}
%It is the case that $T$ is positive and $\con{\Im T} = \mathscr K(H)$, hence $\con{\Im T}^\perp = 0$, so it cant be orthogonally complemented.
%
%Now, notice that $\ker T = 0$, since $S$ is injective. Now, the identity $\sub{\Id}{\mathscr B(H)}$ is trivially a partial isometry, $T = \sub{\Id}{\mathscr B(H)} |T|$ since $T$ is positive and $\ker T = 0 = \ker \sub{\Id}{\mathscr B(H)}$. However, it cannot be a polar decomposition of $T$ as showed.
%\end{contraexemplo}

\begin{teorema}\label{teo: M rank finito sse M = pA^n}
A Hilbert $C^*$-module $M$ has finite rank if, and only if, there exists an idempotent matrix $p\in \mathbb M_{n\times n}(A)$ such that $M$ is isomorphic, as Hilbert $A$-modules, to $p A^{n}$.
\begin{proof}
Assume that $M$ has finite rank, i.e. $\Id = \Omega_y\Omega_x^*$ for some $x,y \in M^n$. As presented in (\ref{eq: Omega_x^*Omega_y eh idempotente}), $\Omega_x^*\Omega_y \in \adj(A^n)$ is an idempotent operator, which corresponds to left multiplication by the idempotent matrix $p\coloneqq (\inner{x_i}{y_j})_{i,j} \in \mathbb M_{n\times n}(A)$.
\begin{equation}
\label{eq: Omega_x^*Omega_y eh idempotente}
    \Id = \Omega_y \Omega_x^* \To \Omega_x^* = (\Omega_x^*\Omega_y) \Omega_x^* \To \Omega_x^*\Omega_y = (\Omega_x^*\Omega_y)^2
\end{equation}
\begin{itroman}
    \item[] \mathbf{\Omega_x^*:M \longto pA^n} \textbf{is invertible}: The middle term of (\ref{eq: Omega_x^*Omega_y eh idempotente}) tells us that $\Omega_x^*= p\Omega_x^* $. Therefore, consider the following:
\begin{equation*}
    \function{T{pA^n}{M}{pa}{\Omega_ya}}
\end{equation*}
That operator show us that $\Omega_x^*$ is an invertible operator: Given $a\in A^n$, $\xi \in M$,  one obtains that $\Omega_x^* T(pa) = \Omega_x^*\Omega_ya = pa$ and $T\Omega_x^* \xi = T(p\Omega_x^*\xi) = \Omega_y\Omega_x^*\xi = \xi$, i.e. $T = \inv{\Omega_x^*}$.
%    \item \label{item:(ii) ida M rank finito sse M=pA^n}\textbf{$\boldsymbol{\con{\Im \Omega_x^*}}$ and $\boldsymbol{\con{\Im \Omega_x}}$ are orthogonally complementable}: 
%\item \textbf{$\boldsymbol{\Omega_x^*}$ is an isomorphism of Hilbert modules}: As in traditional Hilbert spaces, we must check that
%\begin{eqspaced}{(\xi,\zeta \in M)}
%\sub{\inner\xi{\zeta}}M = \sub{\inner{\Omega_x^*\xi}{\Omega_x^*\zeta}}{A^n} 
%\end{eqspaced}
\end{itroman}
Since it is an adjointable, functional continuous calculus allow us to extract the square root $|\Omega_x^*| \coloneqq (\Omega_x\Omega_x^*)^{1/2}$, which is self-adjoint. Besides being a linear bijection, $\Omega_x^*$ doesn't preserves inner products. But notice that $U \coloneqq \Omega_x^*|\Omega_x^*|^{-1}$ does: For $\xi,\zeta \in M$,
\begin{eqspaced*}{}
    \begin{array}{rcl}
        \sub{\inner{U\xi}{U\zeta}}{A^n} &=& \sub{\inner{\Omega_x^*|\Omega_x^*|^{-1}\xi}{\Omega_x^*|\Omega_x^*|^{-1}\zeta}}{A^n} \\
        &=& \vphantom{\int\limits_a^b} \sub{\inner\xi{|\Omega_x^*|^{-1}\Omega_x\Omega_x^*|\Omega_x^*|^{-1}\zeta}}{M}  \\
        &=& 
        \sub{\inner\xi{|\Omega_x^*|^{-1}|\Omega_x^*|^{2}|\Omega_x^*|^{-1}\zeta}}{M}  = \sub{\inner\xi\zeta}{M}.
    \end{array} 
\end{eqspaced*}
Hence $U$ is a Hilbert isomorphism between $M$ and $pA^n$. 
%Let $x$ and $y$ be tuples given the coefficients
\end{proof}
\end{teorema}

\section{Kasparov Stabilization Theorem}
\label{sec: kasparov stabilization}
The Kasparov Stabilization theorem ensures that the standard Hilbert $C^*$-module $\HA$ is in a way, the largest countably generated Hilbert $C^*$-module, i.e. every countably generated Hilbert $C^*$-module is a direct summand in the canonical space $\HA$. Technically, we need the main theorem of this section in order to classify the finite rank Hilbert $C^*$-modules in rank terms (Theorem \ref{teo: M N quasi stably iso ==> rank igual}), requiring some countability condition. 

This may worry some readers, given that we already mentioned that \textsc{Exel}'s approach to Fredholm operators is just the $K$-theoretical version of the BGR theorem without the separability assumption of the $C^*$-algebras. But do not panic since this enumerability shall be dribbled in Lemma \ref{lema: Quasi-stably-isomorphic: X eh enumeravel gerado}. 

%The main result obtained by Exel in \cite{exel7fredholm} is the BGR theorem \ref{teo: BGR-Exel} without any separability condition assumed in the $C^*$-algebras $A$ and $B$. 

Although it has been presented in \cite[Theorem 2]{kasparov1980stinespring} by \textsc{G. G. Kasparov}, we follow \cite{mingo1984equivariant} in the following road map: Defining strictly positive elements in a $C^*$-algebra and characterizing operators in $\mathscr K(E)$ whose range is dense. With this characterization, we prove Kasparov's theorem. 

\begin{definicao}
If $a$ is a positive element in a $C^*$-algebra $A$ and $\phi(a) \neq 0$ for all \textit{states}\footnote{Norm 1 positive linear functional $\phi: A \longto \C$.} $\phi$ on $A$, then $a$ is said to be \textit{strictly positive}.
\end{definicao}

\begin{proposicao}
A positive element $a\geqslant 0$ in a unital $C^*$-algebra $A$ is strictly positive if and only if it is a invertible element.
\begin{proof}[Proof due to \cite{aweygan2020}] 
Suppose $a\in A$ is strictly positive.  Since $A$ is unital, the state space of $A$ is weak$^*$-compact, and it follows that the element $\varepsilon:=\inf\{\phi(a)\mid \phi\text{ is a state on }A\}$ is strictly positive, i.e. $\ep >0$. Therefore $a-\varepsilon$ is a positive element, so that the spectrum of $a$ is contained in $[\varepsilon,\infty)$, i.e. $a$ is invertible since $0$ is not in the spectrum of $a$.

Conversely, suppose that $a$ is positive and invertible. Whence, its spectrum is a compact subset of $(0,\infty)$, and thus $a-\varepsilon$ is positive for some $\varepsilon>0$.  If $\phi$ is a non-zero positive linear functional on $A$, we have
\begin{equation*}
    \phi(a)=\varepsilon\phi(1)+\phi(a-\varepsilon)\geq \varepsilon\|\phi\|+0>0. \qedhere
\end{equation*}
\end{proof}
\end{proposicao}

\begin{lema}
\label{lema: a > 0 sse aA denso em A}
Let $a\in A$ be a positive element. Hence $a$ is strictly positive if, and only if, $aA$ is dense in $A$.
\begin{proof}
Conjure the following statement:
%\vspace{-0.75cm}
\begin{quote}
    \begin{invocacao}[\cite{dixmier1982c} - Lemma 2.9.4]
    Let $A$ be a $C^{*}$-algebra and $L, L^{\prime}$ two closed left ideals of $A$ such that $L \subseteq L^{\prime}$. Suppose every positive form on $A$ that vanishes on $L$ also vanishes on $L^{\prime}$. Then $L=L^{\prime}$.
    \end{invocacao}
\end{quote}
Suppose that $L \coloneqq aA$ is not a dense subset of $L' \coloneqq A$, i.e. $\overline L \neq L'$. By the summoning, there is a state of $A$ vanishing on $aA$. Such a state must vanish on $a$, so $a$ is not strictly positive. Conversely, if $\phi$ is a state which $\phi(a)=0$. Then, by Cauchy-Schwarz inequality for states:
\begin{eqspaced*}{(b\in A)}
    |\phi(ab)|^2 \leqslant \phi(b^*b)\phi(a^*a) = 0
\end{eqspaced*}
i.e. $\phi$ vanishes on $aA$, hence it is not dense.
\end{proof}
\end{lema}

\begin{proposicao}
\label{prop: T > 0 sse Im T densa}
Let $E$ be a Hilbert $A$-module and $T$ a positive element in the $C^*$-algebra $\mathscr K(E)$. Then $T$ is strictly positive if and only if $T$ has dense range.
\begin{proof}
If $T$ is strictly positive, by \ref{lema: a > 0 sse aA denso em A} then $\con{T\mathscr K(E)} = \mathscr K(E)$. Since $\con{\mathscr K(E)E} = E$, we have that $\con{\Im T} = \con{T\mathscr K(E)E} = \con{\mathscr K(E)E} = E$, i.e. $T$ has dense image. Conversely, suppose that $T$ has dense range. Therefore, for any $x,y \in E$, choose a sequence $(z_n)_n\subset E$ with $Tz_n \longto x$. Therefore,
\[
\Omega_x^{\vphantom{*}}\Omega_y^* = \lim_{n\to \infty} T\Omega_{z_n}^{\vphantom{*}}\Omega_y^* \in \con{T\mathscr K(E)}.
\]
So $T\mathscr K(E)$ is dense and $T$ is strictly positive.
\end{proof}
\end{proposicao}

A Hilbert $A$-module $M$ is countably generated if there is a sequence $\left(x_{n}\right)_n \subset M$ such that every $x$ is the limit $A$-linear combinations of $\left(x_{n}\right)_n$.

\begin{teorema}[Kasparov Stabilization Theorem]
\label{teo: kasparov stabilization}
If $M$ is a countably generated Hilbert $A$-module, then $\HA \simeq M\oplus \HA$.
% If this statement is true whenever $A$ is unital, notice that when $M$ is seen as a Hilbert $\widetilde{A}$-module, 

% Consider the case only when $M$ is a Hilbert $\widetilde{A}$-module, which is sufficient since $\con{MA} = M$ and $\con{\HA A} = \HA$. Therefore, a
\begin{proof}
 Assume that $A$ is a unital $C^*$-algebra and let $(\eta_n)_n$ be a bounded sequence of generators for $M$, with each generator repeated infinitely often. Let $(\sub e n)_n$ be the canonical orthonormal basis for $\HA$, i.e. only the $n$-th coordinate of $\sub e n$ is 1 and 0 elsewhere. Define $T:\HA\longto M\oplus \HA$ linearly extending by $T\sub e n \coloneqq 2^{-n} \eta_n + 4^{-n}\sub e n$. Notice that, for the elements $\zeta_n \coloneqq \eta_n+2^{-n}\sub e n$, $T$ can be written as
\begin{equation*}
T = \sum_{n=1}^\infty 2^{-n} \Omega^{\vphantom{*}}_{\zeta_n}\Omega^*_{\sub e n} =  \sum_{n=1}^\infty 2^{-n} (\eta_n+2^{-n}\sub e n)\inner{\sub e n}{\come}.
\end{equation*}
Therefore, $T$ is a compact bijection. Since each $\eta_n$ is repeated infinitely often, it is true that $\eta_n + 2^{-m}\sub e m = T(2^m\sub e m)\in \Im T$ for infinitely many $m$ which $\eta_n=\eta_m$. Going through the limit when $m\longto \infty$, we see that 
\begin{equation*}
    \eta_n + 0 = \lim_{m\to \infty} \eta_n + 2^{-m}\sub e m = \lim_{m\to \infty} T(2^m\sub e m) \in \con{\Im T}
\end{equation*}
and $0 + \sub e n = 4^n (T\sub e n - 2^{-n}(\eta_n + 0))$. Therefore, both $\eta_n + 0$ and $0+\sub e n$ are in the closure $\con{\Im T}$.

Since $\{\eta_n + 0,\,0 + \sub e n  \}_n$ generates a dense submodule of $M\oplus \HA$, $T$ has dense range. Define new operators $S$ and $R$ given by $S\sub e n \coloneqq 0 + 4^{-n}\sub e n$ and $R\sub e n \coloneqq 2^{-n}\eta_n + 0$, in order that
\begin{equation*}
    \begin{array}{rcl}
         T^*T &=& S^*S + R^*R \\ 
         &=& \left(\begin{smallmatrix} 
         4^{-4} & 0 & 0 & \scaleobj{1}{\cdots}\\
         0 & 4^{-8} & 0 & \scaleobj{1}{\cdots}\\
         0 & 0 & 4^{-12} & \scaleobj{1}{\cdots}\\
         \vdots & \vdots & \vdots & \ddots
         \end{smallmatrix}\right) + \left(\begin{smallmatrix} 
         4^{-2}\inner{\sub\eta 1}{\sub\eta 1}\hphantom{i} & 4^{-3}\inner{\sub\eta 1}{\sub\eta 2}\hphantom{i} & 4^{-4}\inner{\sub\eta 1}{\sub\eta 4}\hphantom{i}& \scaleobj{1}{\cdots}\\
         4^{-3}\inner{\sub\eta 2}{\sub\eta 1}\hphantom{i} & 4^{-4}\inner{\sub\eta 2}{\sub\eta 2}\hphantom{i} & 4^{-5}\inner{\sub\eta 2}{\sub\eta 3}\hphantom{i} & \scaleobj{1}{\cdots}\\
         4^{-4}\inner{\sub\eta 3}{\sub\eta 1}\hphantom{i} & 4^{-5}\inner{\sub\eta 3}{\sub\eta 2}\hphantom{i} & 4^{-6}\inner{\sub\eta 3}{\sub\eta 1}\hphantom{i} & \scaleobj{1}{\cdots}\\
         \vdots & \vdots & \vdots & \ddots
         \end{smallmatrix}\right)
    \end{array}
\end{equation*}
Hence $T^*T \geqslant S^*S$. Notice that $S^*S$ has dense range, and by \ref{prop: T > 0 sse Im T densa}, it is strictly positive and so do $T^*T$. Therefore, $T |T|^{-1}$ is the desired  isomorphism between those Hilbert modules.
\end{proof}
\end{teorema}

\begin{corolario}
    All finite rank Hilbert $A$-modules $M$ can be regarded as submodules of $\HA$.
\end{corolario}

\begin{proposicao}
    A Hilbert $A$-module $E$ is countably generated if, and only if $\mathscr K(E)$ contains a strictly positive element, i.e. is $\sigma$-unital.

    \begin{proof}
        If $A$ is unital and $(e_n)_n \subset \HA$ is the canonical orthonormal basis, the operator $h \coloneqq \sum_n 2^{-n} e_n \inner{e_n}{\come}$ is a strictly positive element in $\mathscr K(\HA)$ since it has dense range. If $P\in \adj(\HA)$ is an idempotent self-adjoint operator, then $PhP$ is strictly positive in $\mathscr K(P\HA)$. Finally, notice that $A$ is countably generated if, and only if $\widetilde{A}$ is countably generated. Therefore $\sub{\mathscr K}A(E) = \sub{\mathscr K}{\widetilde{A}}(E)$ is $\sigma$-unital if, and only if $E$ is countably generated.
    \end{proof}
\end{proposicao}

%\begin{proposicao}
%A Hilbert $A$-module $E$ is countably generated if, and only if $\mathscr K(E)$ contains a strictly positive element, i.e. is $\sigma$-unital.
%\begin{proof}
%Assume that $E$ is countably generated and let $\sub\Pi E: E \oplus \HA \longtwoheadrightarrow E\oplus \HA$ be the projection into $E$. Then $E \simeq \sub\Pi E(E\oplus \HA)$. By Kasparov Stabilization theorem \ref{teo: kasparov stabilization}, let $U\in \mathscr K(\HA, E\oplus \HA)$ be the isomorphism given. Notice that it is a $*$-isomorphism the conjugation map:
%\begin{equation*}
%    \functionwithoutname{{\mathscr{L}(E\oplus \HA)}{\mathscr L(\HA)}{T}{\inv UTU}}
%\end{equation*}
%Therefore $P \coloneqq \inv U\sub\Pi EU$ obeys $E\simeq P(\HA)$. If $\psi : E \longto P(\HA)$ is the obtained isomorphism, the same can be said about the conjugation map $\mathscr K(E) \ni T \longmapsto \psi T\inv \psi \in \mathscr K(P(\HA))$, so that $\mathscr K(E) \simeq \mathscr K(P(\HA))$.

%Notice that $\Omega_y\Omega_x^* \sub\restrita{P(\HA)} = \Omega_{P(y)}\Omega_{P(x)}^*$, hence the restriction of operators to $P(\HA)$ yields an isomorphism $P\mathscr K(\HA)P \simeq \mathscr{K}(P(\HA))$:
%\begin{equation*}
%    \functionwithoutname{{P\mathscr K(\HA)P}{\mathscr K(P(\HA)}{P (\lim \Omega_y\Omega_x^*) P}{{\lim \Omega_{Py}\Omega_{Px}^*}}}
%\end{equation*}
%\end{proof}
%\end{proposicao}


\section{Rank definition of Finite Rank Modules}
In order to define the actual \textit{rank} of a finite rank module $M$, we wish to deal with the $K_0$-group as the $K$-algebraic theoreticals like, so we shall visualize our $A$-modules over $\widetilde A$, regardless if it already possesses a unity or not. This process naturally enrich our module, as showed in \ref{prop: M eh finitamente gerado projetivo}.

\begin{definicao}[Projective module]
Let $M$ be an $A$-module. $M$ is \textit{projective} whenever there exists a map $h$ such that it is commutative the following diagram:
\begin{eqspaced*}{(E,F \in \boldsymbol{A\operatorname{-Mod}})}
\begin{tikzcd}
                       & M \arrow[d] \arrow[ld, "h"', dashed] \\
E \arrow[r, two heads] & F                                   
\end{tikzcd}
\end{eqspaced*}
That is to say, for every epimorphism\footnote{For our purpose and needs, subjective morphism} $g: E \longtwoheadrightarrow F$ and $f:M \longto F$, there will always exist a map $h$ such that $g\circ h = f$.
\end{definicao}

\begin{proposicao}\label{prop: M eh finitamente gerado projetivo}
    Let $A$ be a $C^*$-algebra. Every finite rank Hilbert $A$-module is a finitely generated projective Hilbert $\widetilde A$-module.
\begin{proof}
Let $M$ be a finite rank Hilbert $A$-module. If $(a,\lambda) \in \widetilde A$, letting $(a,\lambda)\cdot \xi \coloneqq a\xi + \lambda\xi$ turns $M$ into an Hilbert $\widetilde A$-module. If $p\in \adj({\widetilde{A}}^n)$ is the idempotent such that $M \simeq p{\widetilde{A}}^n$ given by \ref{teo: M rank finito sse M = pA^n}, notice that:
\begin{itroman}
    \item \ensuremath{\boldsymbol{{\widetilde{A}}^n \simeq M \oplus \ker p}}:  We shall see that it is a direct sum:
    \begin{equation}
    \label{eq: ~A^n is a direct summand}
        {{\widetilde{A}}}^n = p{{\widetilde{A}}}^n \oplus (\sub\Id{{\widetilde{A}}^n}-p){{\widetilde{A}}}^n
    \end{equation}
    Indeed, if $x \in p{\widetilde{A}}^n \cap (\sub\Id{{\widetilde{A}}^n}-p){{\widetilde{A}}}^n$, than $x = pa = (\sub\Id{{\widetilde{A}}^n}-p)b$ for some tuples $a, b$. Therefore
    \[
    x = pa = p(pa) = p(\sub\Id{{{\widetilde{A}}}^n}-p)b = (p - p^2)b = 0,
    \]
    and the sum in (\ref{eq: ~A^n is a direct summand}) is fact direct. Since $\ker p = (\sub\Id{{\widetilde{A}}^n}-p){\widetilde{A}}^n$, the desired isomorphism holds since $p\widetilde{A}^n \simeq M$.
    \item \label{item: M projetivo sse M oplus Q livre}\textbf{If there exists $\boldsymbol Q$ such that $\boldsymbol{M\oplus Q}$ is free, then $\boldsymbol M$ is projective}: Let $E$, $F$ be $\widetilde A$-modules, $g:E \longtwoheadrightarrow F$ a surjective map and $f:M \longto F$. Let $(b_i)_i$ be a basis of $M\oplus Q$. By surjectivity, for all $i$, there is always $x_i\in M$  such that $g(x_i) = f(b_i)$. 
    
    Define $\widetilde{h}:M\oplus Q \longto E$ extending linearly $\widetilde{h}(b_i) \coloneqq x_i$, in order that $g \circ \widetilde{h} = f$. Therefore, $h \coloneqq \widetilde{h} \sub{\restrita}{M}$ is the one necessary so that $M$ is projective.
    
    \item \label{item: direct summand}\textbf{If $\boldsymbol M$ is a direct summand of a free rank module, then it is finitely generated}: Let $M\oplus Q \simeq {\widetilde{A}}^n$ for some $\widetilde A$-module $Q$. That way, $Q$ can be both projected and embedded in ${\widetilde{A}}^n$ by morphisms. Let $\psi : {\widetilde{A}}^n \longto {\widetilde{A}}^n$ be the compositions of those. Then
    \[\Im \psi = \{(0,q) \in M \oplus Q \mid q \in Q\}\]
    is the kernel of the canonical projection $\sub \Pi M : {\widetilde{A}}^n \longtwoheadrightarrow M$. Therefore, the composition $\sub \Pi M \circ \psi : {\widetilde{A}}^n \longtwoheadrightarrow M$ is a surjection, telling the world that $M$ must be finitely generated.
\end{itroman}
Since ${\widetilde{A}}^n$ is free module, setting $Q \coloneqq \ker p$, one can see that $M$ is projective by \ref{item: M projetivo sse M oplus Q livre} and finitely generated by \ref{item: direct summand}. 
\end{proof}
\end{proposicao}

\begin{lema}\label{prop: pAm cong qAn sse p ~ q}
Let $p, q$ be idempotent square matrices with entries living in $A$. The following are equivalent:
\begin{itroman}
    \item\label{prop: pAm cong qAn sse p ~ q (i)} As Hilbert modules, $pA^m \simeq q A^n$.
    \item\label{prop: pAm cong qAn sse p ~ q (ii)} $p$ and $q$ are Murray von-Neumann equivalent.
\end{itroman}
\begin{proof}
$\left.\right.$
\begin{itemize}
    \item[$\ref{prop: pAm cong qAn sse p ~ q (i)} \Rightarrow \ref{prop: pAm cong qAn sse p ~ q (ii)}$] Let $T: pA^m \longto qA^n$ be a isomorphism. There exists unique matrices $r \in \mathbb M_{n \times m}(A)$ and $s\in \mathbb M_{m \times n}(A)$ which corresponds $spa = T(pa)$ and $rqb = \inv T(qb)$ for every $a\in A^m$ and $b\in A^n$. Notice that
    \[
    \begin{cases}
        rs(pa) = \inv TT(pa) = pa = p^2a.\\
    sr(qb) = T\inv T(qb) = qb = q^2b.
    \end{cases} 
    \]
    Therefore $p = rs$ and $q = sr$.
    \item[$\ref{prop: pAm cong qAn sse p ~ q (i)} \Leftarrow \ref{prop: pAm cong qAn sse p ~ q (ii)}$] The left multiplications maps $s:pA^m \longto qA^n$ and $r: qA^n \longto pA^m$ are mutual inverses of each otter:
    \[
    \begin{cases}
    s(r(qb)) = (sr)^2b = q^2b = qb, & (b \in A^n).\\
    r(s(pa)) = (rs)^2a = p^2a = pa, & (a \in A^m).\\
    \end{cases}
    \]
    Therefore $ pA^m \simeq qA^n $. \qedhere
\end{itemize}
\end{proof}
\end{lema}


For a $A$-finite rank module $M$, $M$ can be viewed as an finitely gerated projective $\widetilde A$-module, hence let $p$ be as in \ref{teo: M rank finito sse M = pA^n} embedded in $\mathbb M_{\infty}({\widetilde{A}})$. As an element of $V({\widetilde{A}})$, the equivalence class of idempotents which represents $M$, is the set:
\[
[M] \coloneqq  \{q \in \mathbb M_\infty({\widetilde{A}}) \mid q^2 = q \in \mathbb M_{n}({\widetilde{A}}), M \simeq q A^n\} = [p] \in V({\widetilde{A}})
\]
which by \ref{prop: pAm cong qAn sse p ~ q} is well defined.

Letting $[\,\cdot\,]_0 : V({\widetilde{A}}) \longhookrightarrow K_0({\widetilde{A}})$ be the natural inclusion, $[q]_0 \coloneqq [q]- [s(q)]$, one may see $[M]_0 \in K_0({\widetilde{A}})$ as an element of $K_0(A)$. In fact, if $\ep : \widetilde A \longtwoheadrightarrow \C$ is the projection of the complex component, $\ep(p) = 0$ since $M$ is originally a Hilbert $A$-module. Therefore,
\[
\sub\ep0\big([M]_0\big) = \sub\ep0([p] - [s(p)]) = [\ep(p)]- [\ep(s(p))] = 0 
\]
\[
\To [M]_0 \in \ker \sub\ep0 = K_0(A).
\]

\begin{proposicao}\label{prop: compacto idempotente eh rank finito}
Let $P \in \mathscr K(E)$ be a compact self-adjoint idempotent operator over a Hilbert $A$-module $E$. Therefore, $\Im P$ is an $A$-finite rank Hilbert $C^*$-module.
\begin{proof}
Notice that $\sub{\Id}{\Im P} = P$. Since it is compact in $E$, there are nets $(\sub y\lambda)_\lambda, (\sub x\lambda)_\lambda \subset E^{\infty}$ such that $P = \lim_\lambda \Omega_{\sub y\lambda}^{\vphantom{*}}\Omega_{\sub x\lambda}^*$. Therefore:
\begin{eqnarray*}
\sub{\Id}{\Im P} &=& P = P^3 = P\Big(\lim_\lambda \Omega_{\sub y\lambda}^{\vphantom{*}}\Omega_{\sub x\lambda}^*\Big)P\\
&=& \lim_\lambda P\Omega_{\sub y\lambda}^{\vphantom{*}}\Omega_{\sub x\lambda}^*P =  \lim_\lambda \Omega_{P\sub y\lambda}^{\vphantom{*}}\Omega_{P^*\sub x\lambda}^*
\overset{P^*=P}= \lim_\lambda \Omega_{P\sub y\lambda}^{\vphantom{*}}\Omega_{P\sub x\lambda}^*.
\end{eqnarray*}
In light of the \ref{prop: identidade compacta eh de rank finito}, ${\Im P}$ is indeed a finite-rank module.
\end{proof}
\end{proposicao}

\begin{observacao}\label{obs: idempotente gerando inversivel}
    The range of an idempotent operator coincide with the range of some projection, i.e. self-adjoint idempotent operator. To see this, suppose that $a\in A$ is an idempotent in a unital $C^*$-algebra $A$.  Let
    \[
    h \coloneqq 1 + (a-a^*)(a^*-a) = 1 + aa^* - a^* - a + a^*a
    \]
    With $h$ in hands, one can draw the following conclusions: 
    
    \begin{itroman}
        \item $h^* = h$.
        \item Notice that $(a-a^*)(a^*-a) \geqslant 0$, hence $\Spec((a-a^*)(a^*-a)) \subset [0,\infty)$. Conjure one of the classical theorems in spectral theory:        
        \begin{invocacao}[Spectral mapping theorem - \cite{rudin1991functional} - Theorem 10.28.(\textit{b})]
            \label{teo: spectral mapping}
            Given an unital Banach algebra $A$ and $a\in A$, the following holds:
            \begin{equation*}
                \Spec(p(a)) = \{p(\lambda) \mid \lambda \in \Spec(a)\} = p(\Spec(a))
            \end{equation*}
            for each and every complex polynomial $p \in \C[x]$.
        \end{invocacao}
        By the theorem \ref{teo: spectral mapping}, 
        \begin{equation*}
            \Spec(h) = 1 + \Spec((a-a^*)(a^*-a)) \subset [1,\infty).
        \end{equation*}
        Since $0 \notin \Spec(h)$, $h$ is invertible.
        \item $ah = aa^*a = ha$ and $a^*h =  a^*aa^* =ha^*$.
        \item $p \coloneqq aa^*h^{-1} = \inv haa^*$. Indeed:
        \[
        hp = haa^*\inv h = aa^*h\inv h = aa^*.
        \]
        \item $p$ is self-adjoint:
        \[
        p^* = (\inv h)^*aa^* = \inv{(h^*)}aa^* = \inv haa^* = p
        \]
        \item $p$ is idempotent:
        \[
        p^2 = \inv h\underbrace{(aa^*a)}_{ha}a^*\inv h = \inv hh(aa^* \inv h) = p.
        \]
        
        \item \label{item: p eh uma projecao} $pa = a$ and $ap= p$. 
    \end{itroman}
    
    In particular, if $a\coloneqq Q\in \adj(E)$ is an idempotent operator, $\Im Q$ coincides with the range of $p$ by \ref{item: p eh uma projecao}, which is a self-adjoint idempotent operator. In particular $E = \Im Q \oplus \Im Q^{\perp}$.
\end{observacao}


\begin{definicao}
The \textit{rank} of a finite rank Hilbert $A$-module will be defined as the class $\rank(M) \coloneqq [p]_0 \in K_0(A)$. The properties given in \ref{prop: compacto idempotente eh rank finito} and \ref{obs: idempotente gerando inversivel}, we are able to define the \textit{rank} of a given compact idempotent operator $P$ as the rank of $\Im P$.
\end{definicao}

Let $E$ be a Hilbert $A$-module and $P, Q \in \mathscr K(E)$ be two compact idempotent operators. Since their ranges are finite-rank modules (\ref{obs: idempotente gerando inversivel} and \ref{prop: compacto idempotente eh rank finito}), there are $x,y \in (\Im P)^n$ and $z,w \in (\Im Q)^m$ such that 
$$P = \sub\Id{\Im P} = \Omega_{y}^{\,}\Omega_x^* \e Q = \sub\Id{\Im Q} = \Omega_{w}^{\,}\Omega_z^*.$$ 
Let $p$ and $q$ be the matrices given by $p=\left(\inner{x_i}{y_j}\right)_{i,j}$ and $q=\left(\inner{z_i}{w_j}\right)_{i,j}$, used in the argument used in \ref{teo: M rank finito sse M = pA^n}. As seen before, we get the following isomorphic Hilbert $C^*$-modules: $\Im P \simeq pA^n$ and $\Im Q \simeq q A^m$. 


\begin{lema}\label{lema: [P]_0 = [Q]_0 ---> [p]_0 = [q]_0}
    Let $P$ and $Q$ be as in the above conditions. If $P$ and $Q$ are similar, i.e. there exists $u \in \GL \adj(E)$ such that $P = uQ\inv u$, the matrices $p$ and $q$ are Murray-von Neumann equivalent. 
    \begin{proof}
    We have that $P = uQ\inv u$, $\Im P \simeq pA^n$ and $\Im Q \simeq qA^m$. Therefore:
    $$
    \Omega_y\Omega_x^* = P = uQ\inv u = u\Omega_{w}\Omega_z^*\inv u = \Omega_{u(w)}^{\,}\Omega_{({\inv u})^*(z)}^*, $$
        which means that
        $$\sum_{i=1}^n y_i \inner{x_i}{\come} = \sum_{i=1}^m u(w_i)\inner{(\inv u)^*(z_i)}{\come}.$$ 
        Notice that the matrix $\widehat q \coloneqq \left(\inner{(\inv u)^*(z_i)}{u(w_j)}\right)_{i,j}$ obeys $\Im uQ\inv u \simeq \widehat{q}A^m$ by the construction of \ref{teo: M rank finito sse M = pA^n}. But since $\inner{(\inv u)^*(z_i)}{u(w_j)} = \inner{z_i}{w_j}$, one concludes that $\widehat{q} = q$, hence, we obtain two isomorphisms such that the following diagram commutes.
        \begin{equation*}
\begin{tikzcd}
    \Im P \arrow[d]        & \Im uQu^{-1} \arrow[l, no head, equal] \arrow[d] \arrow[r, dashed] & \Im Q \arrow[d] \\
    pA^n \arrow[r, dashed] & qA^m \arrow[r, no head, equal]                                     & qA^m           
    \end{tikzcd}
        \end{equation*}
        Since $pA^n\simeq qA^m$ if, and only if $p$ and $q$ are Murray-von Neumann equivalent by \ref{prop: pAm cong qAn sse p ~ q}, the result follows. 
    \end{proof}   
\end{lema}

\begin{corolario}
    \label{corol: [P]_0 =[Q]_0 ---> rank(P) = rank(Q)}
    Let $P$ and $Q$ be compact idempotent operators in $\mathscr L(E)$. If $[P]_0 = [Q]_0$, then $\rank(P) = \rank(Q)$.
\end{corolario}


\section{Quasi-stably-isomorphic Hilbert modules}

If $X, Y, Z$ and $W$ are Hilbert $A$-modules and $T$ is in $\adj(X \oplus Y, Z \oplus W)$, then $T$ can be represented by a matrix
$$
T=\begin{pmatrix}
\sub{T}{Z X} & \sub{T}{Z Y} \\
\sub{T}{W X} & \sub{T}{W Y}
\end{pmatrix}
$$
where $\sub{T}{Z X}$ is in $\adj(X, Z)$ and similarly for the other matrix entries. Matrix notation is used to define our next important concept.

We are in touch with pretty algebraic properties of Hilbert modules, and in our case of finite rank ones. Since those modules can be seen as projective finitely generated, an algebraist might convince you that two generators $[M]_0,[N]_0 \in K_0(A)$ are equal if, and only if they are \textit{stably-isomorphic}, i.e. there exists $n$ such that $ M \oplus A^n \simeq N \oplus A^n$. We will present a generalization of this concept in terms of the \rank, darkly hidden:

\begin{definicao}[Quasi-stably-isomorphic finite rank]
\label{def: quasi-stabli-isomorphic}
Two Hilbert modules $E$ and $F$ are said to be \textit{quasi-stably-isomorphic} if there exists a Hilbert module $X$ and an invertible operator $T \in \GL \adj(E \oplus X, F \oplus X)$ such that $\sub{\Id}{X}-\sub T{X X}$ is compact.
\end{definicao}

Notice that this is an equivalence relation. Before lighting that relationship, first we enrich the definition on the special case of finite-rank modules.

\begin{lema}\label{lema: Quasi-stably-isomorphic: X eh enumeravel gerado}
Assume $M$ and $N$ are $A$-finite rank modules. If $M$ and $N$ are quasi-stably-isomorphic then the module $X$ referred to in \ref{def: quasi-stabli-isomorphic} can be taken to be countably generated.
\begin{proof}
Let $X$ and $T$ as in \ref{def: quasi-stabli-isomorphic}. Using matrix notation, we have:
\begin{equation*}
    \function{{T}{M\oplus X}{N\oplus X}{(\xi,\eta)}{\left(\begin{smallmatrix}
     \sub{T}{NM} & \sub T{NX} \\ \sub T{XM} & \sub T{XX}
    \end{smallmatrix}\right) \left( \begin{smallmatrix}
     \xi \\ \eta
    \end{smallmatrix}\right)}}
\end{equation*}
Since it is an invertible operator, consider the inverse given in matrix notation as well:
\begin{equation*}
    \inv T = \begin{pmatrix}
    \sub{S}{MN} & \sub S{MX} \\ \sub S{XN} & \sub S{XX}
    \end{pmatrix}
\end{equation*}
We shall construct inductively a enumerable collection $\mathscr C\subset X$ in order to generate a specific submodule. Such a construction will be given by a collection $(\mathscr C_n)_{n\in \N} \subset \wp(X)$, in order that each $\mathscr C_n\subset X$ satisfies:
\begin{itroman}
    \item \label{item: imagens contidas no gerador} The images of the operators $\sub{T}{X M}^{\vphantom{*}}, \sub{S}{X N}, \sub{T}{N X}^{*}$ and $\sub{S}{XM}^{*}$ are contained in the submodule of $X$ generated by ${\mathscr C}_n$.
    
    \item \label{item: aproximacao de Id-T_XX} $\sub{\Id}{X}-\sub{T}{X X}$ can be approximated by finite rank operators of the form $\Omega_{y} \Omega_{x}^{*}$, where the components of $x$ and $y$ belong to ${\mathscr C}_n$.
\end{itroman}
For a given $i \leqslant n$, let $\Pi_i$ be the projection in the $i$-th coordinate of a tuple. In order to choose wisely, we write a technical issue:
\begin{enumerate}[label=\ensuremath{(\roman*)}]
    \setcounter{enumi}{2}
    \item \textbf{Choice of generators}: Let $r\in \adj(P,X)$ where $P$ is a finite rank Hilbert module. By assumption, there exists a natural number $n \in \N$ and tuples $x, y \in P^{n}$ such that $\sub\Id{P} = \Omega^{\vphantom{*}}_{y} \Omega_{x}^*$. Notice that their existence depends on the domain of $r$. Therefore,
\[
r = r\Omega^{\vphantom{*}}_{y} \Omega_{x}^* = \sum_{i=1}^{n} r\Pi_iy\inner{\Pi_ix}{\come}
\]
    We are using the $i$-th coordinate projection $\Pi_i$ since new indexes are about to come. Hence, $\Im r$ is contained in the submodule generated by $\big(r\Pi_iy\big)_{i \leq n}$.
\end{enumerate}

In order to obey \ref{item: imagens contidas no gerador}, our initial collection $\sub{\mathscr C}0$ must contain all elements of the form $r\pi_i(y(r))$ for $r$ varying over the desired operators. Since $\sub\Id X- \sub T{XX}$ is a compact set, there exists tuple sequences $(\boldsymbol{\xi}_n)_{n\in \N}, (\boldsymbol{\zeta}_n)_{n\in \N}$ such that
\[
\sub\Id X - \sub T{XX} = \lim_{n\to \infty} \Omega_{\boldsymbol{\zeta}_n} \Omega_{\boldsymbol{\xi}_n}^*.
\]
To facilitate the notation, write $\mathscr O \coloneqq \{\sub{T}{X M}^{\vphantom{*}}, \sub{S}{X N}^{\vphantom{*}}, \sub{T}{N X}^{*},\sub{S}{XM}^{*}\}$. Let $\sub{\mathscr C}0$ be given by:
\begin{equation*}
    % \begin{array}{rcl}
        \sub{\mathscr C}0 \coloneqq {\big\{ r\Pi_iy \mid r\in \mathscr O, \sub\Id{\operatorname{dom}(r)} = \Omega_y^{\,}\Omega_x^*\big\}}_{i\in \mathbb N}  \cup \bigcup\limits_{n\in \N} \{\Pi_i\boldsymbol{\xi_n} , \Pi_i\boldsymbol{\zeta_n} \}_{i \in \N}
    % \end{array}
\end{equation*}
By construction, those properties are obeyed. Inductively, we set new collections in order to obey to above properties in terms of the operator $\sub T{XX}^{\vphantom{*}}$ and $\sub{S}{XX}$:
\begin{eqspaced*}{(n\in \mathbb N)}
% \begin{array}{rcl}
    \mathscr C_{n+1} = \mathscr C_n \cup \bigcup\limits_{r \in \mathscr O} r\left(\mathscr C_n\right)
% \end{array}
\end{eqspaced*}
in order that each $\mathscr C_n$ satisfies \ref{item: imagens contidas no gerador} and \ref{item: aproximacao de Id-T_XX}. Therefore, the union $\mathscr C\coloneqq \bigcup_{n} \mathscr C_{n}$ is then obviously countable, and also obeys those same properties above. In addition, the following one belongs to package:
\begin{enumerate}[label=\ensuremath{(\roman*)}]
    \setcounter{enumi}{3}
    \item \label{item: (iii)} \textbf{$\boldsymbol{\mathscr C}$ is invariant under $\boldsymbol{\sub{T}{X X}^{\vphantom{*}}, \sub{T}{X X}^{-1}, \sub{T}{X X}^{*}}$ and $\boldsymbol{(\sub{T}{X X}^{-1})^{*}}$.} Let $r \in \adj (X)$ be one of the operators. If it was the case that $\mathscr C$ wasn't invariant over $r$, necessarily it would exists $w \in r(\mathscr C)\backslash \mathscr C$, hence, $\inv r(w) \in \mathscr C_n$ for some $n$. However, 
    \[
    w = r(\inv r(w)) \in \mathscr C_n \cup r(\mathscr C_n) \subset \mathscr C_{n+1} \subset \mathscr C
    \]
    i.e. it cannot be the case.
\end{enumerate}

Let $X'$ be the Hilbert submodule of $X$ generated by $\mathscr C$. Because of \ref{item: imagens contidas no gerador} and \ref{item: (iii)} we see that 
$$T\left(M \oplus X'\right) \subseteq N \oplus X' \e T^{*}\left(N \oplus X'\right) \subseteq M \oplus X'.$$ 
The restriction of $T$ then gives an operator $T^{\prime}$ in $\adj\left(M \oplus X', N \oplus X'\right)$. The same reasoning applies to ${\inv T}$ providing $({\inv T})^{\prime}$ in $\adj\left(N \oplus X', M \oplus X'\right)$ which is obviously the inverse of $T^{\prime}$. In virtue of \ref{item: aproximacao de Id-T_XX} it is clear that $T^{\prime}$ satisfies the conditions of definition \ref{def: quasi-stabli-isomorphic}.
\end{proof}
\end{lema}

In terms of the Morita-Rieffel equivalence, this is a big deal since we are not restricting ourselves into $C^*$-algebras with countably approximate identities. After studying Fredholm operators between Hilbert $C^*$-modules, one shall construct group morphisms $K_*(A) \longto K_*(B)$ for generic $C^*$-algebras $A$ and $B$. Those maps turn out to be isomorphisms when $A$ and $B$ are Morita-Rieffel equivalent.

\begin{teorema}\label{teo: M N quasi stably iso ==> rank igual}
Let $M$ and $N$ be quasi-stably-isomorphic finite rank Hilbert modules over a $C^*$-algebra $A$. Therefore, $\rank(M) = \rank(N)$.
\begin{proof}
Let $T \in \GL(\adj(M\oplus X, N\oplus X))$ with $X$ being a countably generated Hilbert module (\ref{lema: Quasi-stably-isomorphic: X eh enumeravel gerado}) and $\sub \Id X - \sub T{XX} \in \mathscr K(X)$. By the countability condition, we can apply Kasparov's Stabilization Theorem \ref{teo: kasparov stabilization} in order to obtain that $X \oplus \HA \simeq \HA$. Without loss of generality, we can assume that $X = \HA$.

Since $M$ is finitely generated as an $A$-module, by Kasparov's theorem again, there exists a isomorphism $\varphi :\HA \longto M\oplus \HA$. Now, we construct operators $F$ and $G$ given by the compositions:
\begin{equation*}
    \begin{array}{c}
         F: \HA \overset{\varphi}{\longto} M\oplus \HA \overset{T}{\longto} N\oplus \HA \longtwoheadrightarrow \HA \longhookrightarrow M\oplus \HA \overset{\inv \varphi}{\longto} {\HA}\\
    \vphantom{\displaystyle\int\limits^b}G: \HA \overset{\varphi}{\longto} M\oplus \HA \longtwoheadrightarrow \HA \longhookrightarrow N \oplus \HA \overset{\inv T}{\longto} M\oplus \HA \overset{\inv \varphi}{\longto} {\HA} 
    \end{array}
\end{equation*}

Those are the first moments we are dealing with some generalized Fredholm operators, which will be introduced in Chapter \ref{ch:fredholm operators}. But this is not important for this particular proof. We state that
\begin{itroman}
    \item \label{teo item: I-FG e I-GF sao compactos}\textbf{Both $\boldsymbol{\Id - FG}$ and $\boldsymbol{\Id - GF}$ are compact}: Let $\sub\Pi{M} = \sub\Id{M} \oplus 0$ and $\sub\Pi{\HA} = 0 \oplus \Id$ be the coordinate projections. When composing, one can simplify:
\begin{equation*}
    \begin{array}{c}
    FG: \HA \overset{\varphi}{\longto} M\oplus \HA \overset{\sub{\Pi}{\HA} }{\longto} M\oplus \HA \overset{\inv \varphi}{\longto} {\HA}
    \\
    \vphantom{\displaystyle\int\limits^b}GF: \HA \overset{\varphi}{\longto} M\oplus \HA \overset{T}{\longto} N\oplus \HA \overset{\sub\Pi{\HA}}{\longto} N \oplus \HA \overset{\inv T}{\longto} M\oplus \HA \overset{\inv \varphi}{\longto} {\HA}  
    \end{array}
\end{equation*}
Meaning that
\begin{equation*}
    \begin{array}{rcl}
        \Id - FG &=& \Id - \inv \varphi \sub\Pi{\HA}\varphi \\
        &=& \inv \varphi\sub\Pi M \varphi 
    \end{array}
\e 
\begin{array}{rcl}
     \Id - GF &=& \Id - \inv \varphi{\inv T} \sub\Pi{\HA} T\varphi  \\
     &=& \inv{(T\varphi)} \sub\Pi N(T\varphi)
\end{array}
    \end{equation*}
   Therefore, $I-FG$ and $I-GF$ are unitarily equivalent to $\sub\Pi M$ and $\sub \Pi N$, which are compact operators.
    
    \item \mathbf{\Id - FG}  \textbf{and} \mathbf{\Id - GF} \textbf{are idempotents}: Notice that $F = \inv \varphi(\sub 0M \oplus \sub{\Pi}{\HA} T\varphi(\come))$. Therefore:
    \begin{equation*}
    \begin{array}{rcl}
         FGF &=& \inv \varphi(\sub 0M \oplus \sub{\Pi}{\HA} T\varphi GF(\come)) \\
         &=& \inv \varphi\big(\sub 0M \oplus \sub{\Pi}{\HA} T\varphi\inv \varphi\inv T \sub\Pi{\HA}T\varphi(\come)\big) \\
         &=&\inv \varphi(\sub 0M \oplus \sub{\Pi}{\HA} T\varphi(\come)) = F.
    \end{array}
    \end{equation*}
    Similarly, one can check that $GFG=G$. Hence, $\Id-FG$ and $\Id - GF$ are idempotents.

    \item \label{teo item: F e G sao Fredholm}\mathbf{F} \textbf{and} \mathbf{G} \textbf{are compact perturbations of the identity}: The operators which ignores $\varphi$ and $\inv\varphi$ in the constructions of $F$ and $G$, are represented by
    \begin{equation*}
        F' \coloneqq 
        \begin{pmatrix}
            0 & 0 \\
            \sub{T}{\HA M} & \sub{T}{\HA\HA}
        \end{pmatrix} \e G' \coloneqq \begin{pmatrix}
            0 & \sub{S}{M\HA} \\
            0 & \sub S{\HA\HA}
        \end{pmatrix}
    \end{equation*}
    where $S \coloneqq \inv T$. Since $\sub{T}{\HA\HA}$ is a compact perturbation of the identity and both $M$ and $N$ are finite rank modules (and so any operator having either $M$ or $N$ as domain or codomain must be compact), one concludes that $F'$ and $G'$, hence, $F$ and $G$ are indeed, compact perturbations of the identity.
\end{itroman}
For sake of notation, let $\mathscr Q(E) \coloneqq {\adj(E)}/{\mathscr K(E)}$ for a Hilbert $A$-module $E$. Since the compact set is an ideal of the adjointable maps, one can consider the following exact sequence of $C^*$-algebras:
\begin{equation}
    \label{eq:seq exata de C-star em K(H_A)}
\begin{tikzcd}
0 \arrow[r] & \mathscr K(\HA) \arrow[r, hook] & \adj(\HA) \arrow[r, "\pi", two heads] & \mathscr Q(\HA) \arrow[r] & 0
\end{tikzcd}
\end{equation}

Notice that we can consider the index map $\partial$ induced by (\ref{eq:seq exata de C-star em K(H_A)}). As stated in item \ref{teo item: F e G sao Fredholm}, one concludes that $\pi(F)= \sub1{\mathscr Q(\HA)}$. Since $\Id_2$ is a lift of $\diag(\sub1{\mathscr Q(\HA)}, \inv{\sub1{\mathscr Q(\HA)}})$, one can obtain that 
$$\partial([\sub1{\mathscr Q(\HA)}]_1) = [\Id_2 p_2\Id_2^{-1}]_0 - [p_2]_0 = 0.$$

We can extract more information by writing down who is the index in terms of $F$ and $G$. By \ref{teo item: I-FG e I-GF sao compactos}, is easy to see that $\pi(F)$ and $\pi(G)$ are each others inverse in $\mathscr Q(\HA)$. In order to compute the index, the element  
\begin{equation*}
    w \coloneqq \begin{pmatrix}
        F & \Id - FG \\ \Id-GF & G
    \end{pmatrix} \in \GL_2^{(0)}({\mathscr Q(\HA)})
\end{equation*}
is a lift of $\diag(\pi(F), \pi(F)^{-1})$, and its inverse just swaps $F$ and $G$ places. Therefore:
\begin{equation*}
    \label{eq: index pi(F)}
 \begin{array}{rcl}
    0 &=& \partial\left(\left[\pi(F)\right]_1\right) \vspace{0.125cm}\\
    &=& \left[w\sub p2 \inv w\right]_0 - \left[\sub p2\right]_0 \vspace{0.125cm}\\
    &=&  \left[\left(\begin{smallmatrix}
        F & \Id - FG \\ \Id - GF & G
    \end{smallmatrix}\right)\left(\begin{smallmatrix}
        \vphantom{F \Id-FG}\Id & 0 \\ \vphantom{F \Id-FG} 0 & 0   
    \end{smallmatrix}\right)\left(\begin{smallmatrix}
        G & \Id - GF \\ \Id - FG & F
    \end{smallmatrix}\right)\right]_0 - \left[\left(\begin{smallmatrix}
        \vphantom{F \Id-FG}\Id & \vphantom{F \Id-FG}0 \\ \vphantom{F \Id-FG} 0 & 0   
    \end{smallmatrix}\right)\right]_0 \vspace{0.125cm}\\
    &=&  \left[\left(\begin{smallmatrix}
        FG & 0 \\ 0 & \Id - GF 
    \end{smallmatrix}\right)\right]_0 - \left[\left(\begin{smallmatrix}
        \vphantom{F \Id-FG}\Id & \vphantom{F \Id-FG}0 \\ \vphantom{F \Id-FG} 0 & 0   
    \end{smallmatrix}\right)\right]_0 \vspace{0.125cm}\\
    &=& \left[\Id - GF\right]_0 - \left[\Id - FG\right]_0
 \end{array}
\end{equation*}
Hence $[\Id - FG]_0 = [\Id - GF]_0$ and by the corollary \ref{corol: [P]_0 =[Q]_0 ---> rank(P) = rank(Q)}, one obtains that $\rank(\Id-FG) = \rank(\Id - GF)$. We had seen that $\Id - FG = \inv\varphi \sub\Pi{M}\varphi$, i.e. $\Im(\Id - FG) \simeq M$. Therefore:
\begin{equation*}
    \rank(M) = [M]_0 = [\Im(\Id - FG)]_0 = \rank(\Id-FG).
\end{equation*} 
Similarly, one obtains that $\rank(N) = \rank(\Id-GF)$ and consequentially, $\rank(M) = \rank(N)$ as we were looking.
\end{proof}
\end{teorema}
